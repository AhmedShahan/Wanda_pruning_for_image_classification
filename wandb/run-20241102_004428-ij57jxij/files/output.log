Set warmup steps = 8750
Set warmup steps = 0
Max WD = 0.0500000, Min WD = 0.0000040
Param groups = {
  "decay": {
    "weight_decay": 0.05,
    "params": [
      "downsample_layers.0.0.weight",
      "downsample_layers.1.1.weight",
      "downsample_layers.2.1.weight",
      "downsample_layers.3.1.weight",
      "stages.0.0.dwconv.weight",
      "stages.0.0.pwconv1.weight",
      "stages.0.0.pwconv2.weight",
      "stages.0.1.dwconv.weight",
      "stages.0.1.pwconv1.weight",
      "stages.0.1.pwconv2.weight",
      "stages.0.2.dwconv.weight",
      "stages.0.2.pwconv1.weight",
      "stages.0.2.pwconv2.weight",
      "stages.1.0.dwconv.weight",
      "stages.1.0.pwconv1.weight",
      "stages.1.0.pwconv2.weight",
      "stages.1.1.dwconv.weight",
      "stages.1.1.pwconv1.weight",
      "stages.1.1.pwconv2.weight",
      "stages.1.2.dwconv.weight",
      "stages.1.2.pwconv1.weight",
      "stages.1.2.pwconv2.weight",
      "stages.2.0.dwconv.weight",
      "stages.2.0.pwconv1.weight",
      "stages.2.0.pwconv2.weight",
      "stages.2.1.dwconv.weight",
      "stages.2.1.pwconv1.weight",
      "stages.2.1.pwconv2.weight",
      "stages.2.2.dwconv.weight",
      "stages.2.2.pwconv1.weight",
      "stages.2.2.pwconv2.weight",
      "stages.2.3.dwconv.weight",
      "stages.2.3.pwconv1.weight",
      "stages.2.3.pwconv2.weight",
      "stages.2.4.dwconv.weight",
      "stages.2.4.pwconv1.weight",
      "stages.2.4.pwconv2.weight",
      "stages.2.5.dwconv.weight",
      "stages.2.5.pwconv1.weight",
      "stages.2.5.pwconv2.weight",
      "stages.2.6.dwconv.weight",
      "stages.2.6.pwconv1.weight",
      "stages.2.6.pwconv2.weight",
      "stages.2.7.dwconv.weight",
      "stages.2.7.pwconv1.weight",
      "stages.2.7.pwconv2.weight",
      "stages.2.8.dwconv.weight",
      "stages.2.8.pwconv1.weight",
      "stages.2.8.pwconv2.weight",
      "stages.3.0.dwconv.weight",
      "stages.3.0.pwconv1.weight",
      "stages.3.0.pwconv2.weight",
      "stages.3.1.dwconv.weight",
      "stages.3.1.pwconv1.weight",
      "stages.3.1.pwconv2.weight",
      "stages.3.2.dwconv.weight",
      "stages.3.2.pwconv1.weight",
      "stages.3.2.pwconv2.weight",
      "head.weight"
    ],
    "lr_scale": 1.0
  },
  "no_decay": {
    "weight_decay": 0.0,
    "params": [
      "downsample_layers.0.0.bias",
      "downsample_layers.0.1.weight",
      "downsample_layers.0.1.bias",
      "downsample_layers.1.0.weight",
      "downsample_layers.1.0.bias",
      "downsample_layers.1.1.bias",
      "downsample_layers.2.0.weight",
      "downsample_layers.2.0.bias",
      "downsample_layers.2.1.bias",
      "downsample_layers.3.0.weight",
      "downsample_layers.3.0.bias",
      "downsample_layers.3.1.bias",
      "stages.0.0.gamma",
      "stages.0.0.dwconv.bias",
      "stages.0.0.norm.weight",
      "stages.0.0.norm.bias",
      "stages.0.0.pwconv1.bias",
      "stages.0.0.pwconv2.bias",
      "stages.0.1.gamma",
      "stages.0.1.dwconv.bias",
      "stages.0.1.norm.weight",
      "stages.0.1.norm.bias",
      "stages.0.1.pwconv1.bias",
      "stages.0.1.pwconv2.bias",
      "stages.0.2.gamma",
      "stages.0.2.dwconv.bias",
      "stages.0.2.norm.weight",
      "stages.0.2.norm.bias",
      "stages.0.2.pwconv1.bias",
      "stages.0.2.pwconv2.bias",
      "stages.1.0.gamma",
      "stages.1.0.dwconv.bias",
      "stages.1.0.norm.weight",
      "stages.1.0.norm.bias",
      "stages.1.0.pwconv1.bias",
      "stages.1.0.pwconv2.bias",
      "stages.1.1.gamma",
      "stages.1.1.dwconv.bias",
      "stages.1.1.norm.weight",
      "stages.1.1.norm.bias",
      "stages.1.1.pwconv1.bias",
      "stages.1.1.pwconv2.bias",
      "stages.1.2.gamma",
      "stages.1.2.dwconv.bias",
      "stages.1.2.norm.weight",
      "stages.1.2.norm.bias",
      "stages.1.2.pwconv1.bias",
      "stages.1.2.pwconv2.bias",
      "stages.2.0.gamma",
      "stages.2.0.dwconv.bias",
      "stages.2.0.norm.weight",
      "stages.2.0.norm.bias",
      "stages.2.0.pwconv1.bias",
      "stages.2.0.pwconv2.bias",
      "stages.2.1.gamma",
      "stages.2.1.dwconv.bias",
      "stages.2.1.norm.weight",
      "stages.2.1.norm.bias",
      "stages.2.1.pwconv1.bias",
      "stages.2.1.pwconv2.bias",
      "stages.2.2.gamma",
      "stages.2.2.dwconv.bias",
      "stages.2.2.norm.weight",
      "stages.2.2.norm.bias",
      "stages.2.2.pwconv1.bias",
      "stages.2.2.pwconv2.bias",
      "stages.2.3.gamma",
      "stages.2.3.dwconv.bias",
      "stages.2.3.norm.weight",
      "stages.2.3.norm.bias",
      "stages.2.3.pwconv1.bias",
      "stages.2.3.pwconv2.bias",
      "stages.2.4.gamma",
      "stages.2.4.dwconv.bias",
      "stages.2.4.norm.weight",
      "stages.2.4.norm.bias",
      "stages.2.4.pwconv1.bias",
      "stages.2.4.pwconv2.bias",
      "stages.2.5.gamma",
      "stages.2.5.dwconv.bias",
      "stages.2.5.norm.weight",
      "stages.2.5.norm.bias",
      "stages.2.5.pwconv1.bias",
      "stages.2.5.pwconv2.bias",
      "stages.2.6.gamma",
      "stages.2.6.dwconv.bias",
      "stages.2.6.norm.weight",
      "stages.2.6.norm.bias",
      "stages.2.6.pwconv1.bias",
      "stages.2.6.pwconv2.bias",
      "stages.2.7.gamma",
      "stages.2.7.dwconv.bias",
      "stages.2.7.norm.weight",
      "stages.2.7.norm.bias",
      "stages.2.7.pwconv1.bias",
      "stages.2.7.pwconv2.bias",
      "stages.2.8.gamma",
      "stages.2.8.dwconv.bias",
      "stages.2.8.norm.weight",
      "stages.2.8.norm.bias",
      "stages.2.8.pwconv1.bias",
      "stages.2.8.pwconv2.bias",
      "stages.3.0.gamma",
      "stages.3.0.dwconv.bias",
      "stages.3.0.norm.weight",
      "stages.3.0.norm.bias",
      "stages.3.0.pwconv1.bias",
      "stages.3.0.pwconv2.bias",
      "stages.3.1.gamma",
      "stages.3.1.dwconv.bias",
      "stages.3.1.norm.weight",
      "stages.3.1.norm.bias",
      "stages.3.1.pwconv1.bias",
      "stages.3.1.pwconv2.bias",
      "stages.3.2.gamma",
      "stages.3.2.dwconv.bias",
      "stages.3.2.norm.weight",
      "stages.3.2.norm.bias",
      "stages.3.2.pwconv1.bias",
      "stages.3.2.pwconv2.bias",
      "norm.weight",
      "norm.bias",
      "head.bias"
    ],
    "lr_scale": 1.0
  }
}
/home/shahanahmed/.local/lib/python3.10/site-packages/timm/utils/cuda.py:50: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self._scaler = torch.cuda.amp.GradScaler()

Current sparsity level: 0.00176105406222953
Block 0
Layer: 0.pwconv1, Metric before mask: tensor([[0.0052, 0.0349, 0.0235,  ..., 0.0014, 0.0107, 0.0113],
        [0.0239, 0.0175, 0.0178,  ..., 0.0110, 0.0090, 0.0043],
        [0.0005, 0.0079, 0.0024,  ..., 0.0028, 0.0040, 0.0026],
        ...,
        [0.0162, 0.0167, 0.0065,  ..., 0.0159, 0.0104, 0.0283],
        [0.0015, 0.0216, 0.0425,  ..., 0.0245, 0.0415, 0.0108],
        [0.0058, 0.0047, 0.0113,  ..., 0.0129, 0.0120, 0.0110]],
       device='cuda:0')
W_mask for 0.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 96])
Weight shape for 0.pwconv1: torch.Size([384, 96])
Non-zero weights for 0.pwconv1 after pruning: 36864
Layer: 0.pwconv2, Metric before mask: tensor([[0.0118, 0.0243, 0.0114,  ..., 0.0046, 0.0025, 0.0166],
        [0.0306, 0.0134, 0.0277,  ..., 0.0026, 0.0269, 0.0008],
        [0.0108, 0.0276, 0.0058,  ..., 0.0362, 0.0067, 0.0460],
        ...,
        [0.0254, 0.0033, 0.0071,  ..., 0.0088, 0.0419, 0.0240],
        [0.0011, 0.0292, 0.0027,  ..., 0.0292, 0.0320, 0.0088],
        [0.0012, 0.0097, 0.0262,  ..., 0.0437, 0.0432, 0.0297]],
       device='cuda:0')
W_mask for 0.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([96, 384])
Weight shape for 0.pwconv2: torch.Size([96, 384])
Non-zero weights for 0.pwconv2 after pruning: 36864
Layer: 1.pwconv1, Metric before mask: tensor([[0.0115, 0.0187, 0.0029,  ..., 0.0038, 0.0085, 0.0489],
        [0.0020, 0.0380, 0.0376,  ..., 0.0024, 0.0410, 0.0260],
        [0.0191, 0.0244, 0.0130,  ..., 0.0504, 0.0034, 0.0032],
        ...,
        [0.0083, 0.0219, 0.0173,  ..., 0.0218, 0.0071, 0.0071],
        [0.0139, 0.0332, 0.0034,  ..., 0.0326, 0.0032, 0.0130],
        [0.0256, 0.0234, 0.0003,  ..., 0.0305, 0.0250, 0.0198]],
       device='cuda:0')
W_mask for 1.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 96])
Weight shape for 1.pwconv1: torch.Size([384, 96])
Non-zero weights for 1.pwconv1 after pruning: 36864
Layer: 1.pwconv2, Metric before mask: tensor([[0.0058, 0.0133, 0.0319,  ..., 0.0088, 0.0209, 0.0039],
        [0.0159, 0.0188, 0.0032,  ..., 0.0188, 0.0259, 0.0095],
        [0.0171, 0.0103, 0.0408,  ..., 0.0203, 0.0074, 0.0056],
        ...,
        [0.0037, 0.0143, 0.0088,  ..., 0.0026, 0.0068, 0.0158],
        [0.0110, 0.0057, 0.0199,  ..., 0.0400, 0.0200, 0.0256],
        [0.0358, 0.0318, 0.0201,  ..., 0.0080, 0.0210, 0.0018]],
       device='cuda:0')
W_mask for 1.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([96, 384])
Weight shape for 1.pwconv2: torch.Size([96, 384])
Non-zero weights for 1.pwconv2 after pruning: 36864
Layer: 2.pwconv1, Metric before mask: tensor([[0.0224, 0.0158, 0.0135,  ..., 0.0273, 0.0435, 0.0240],
        [0.0170, 0.0112, 0.0110,  ..., 0.0279, 0.0298, 0.0050],
        [0.0073, 0.0057, 0.0070,  ..., 0.0155, 0.0068, 0.0451],
        ...,
        [0.0231, 0.0192, 0.0099,  ..., 0.0221, 0.0268, 0.0261],
        [0.0052, 0.0153, 0.0341,  ..., 0.0077, 0.0139, 0.0035],
        [0.0087, 0.0131, 0.0025,  ..., 0.0017, 0.0088, 0.0068]],
       device='cuda:0')
W_mask for 2.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 96])
Weight shape for 2.pwconv1: torch.Size([384, 96])
Non-zero weights for 2.pwconv1 after pruning: 36864
Layer: 2.pwconv2, Metric before mask: tensor([[0.0153, 0.0272, 0.0355,  ..., 0.0080, 0.0046, 0.0622],
        [0.0203, 0.0164, 0.0483,  ..., 0.0238, 0.0169, 0.0212],
        [0.0136, 0.0056, 0.0109,  ..., 0.0137, 0.0074, 0.0030],
        ...,
        [0.0115, 0.0205, 0.0046,  ..., 0.0157, 0.0287, 0.0016],
        [0.0252, 0.0328, 0.0252,  ..., 0.0150, 0.0158, 0.0152],
        [0.0026, 0.0331, 0.0146,  ..., 0.0474, 0.0119, 0.0003]],
       device='cuda:0')
W_mask for 2.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([96, 384])
Weight shape for 2.pwconv2: torch.Size([96, 384])
Non-zero weights for 2.pwconv2 after pruning: 36864
Block 1
Layer: 0.pwconv1, Metric before mask: tensor([[0.0106, 0.0143, 0.0120,  ..., 0.0152, 0.0100, 0.0254],
        [0.0261, 0.0024, 0.0061,  ..., 0.0506, 0.0019, 0.0144],
        [0.0022, 0.0072, 0.0327,  ..., 0.0021, 0.0022, 0.0019],
        ...,
        [0.0222, 0.0245, 0.0156,  ..., 0.0088, 0.0354, 0.0054],
        [0.0092, 0.0253, 0.0295,  ..., 0.0077, 0.0034, 0.0487],
        [0.0020, 0.0182, 0.0167,  ..., 0.0295, 0.0134, 0.0138]],
       device='cuda:0')
W_mask for 0.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([768, 192])
Weight shape for 0.pwconv1: torch.Size([768, 192])
Non-zero weights for 0.pwconv1 after pruning: 147456
Layer: 0.pwconv2, Metric before mask: tensor([[0.0003, 0.0400, 0.0210,  ..., 0.0174, 0.0155, 0.0373],
        [0.0232, 0.0074, 0.0072,  ..., 0.0024, 0.0055, 0.0343],
        [0.0293, 0.0180, 0.0409,  ..., 0.0077, 0.0019, 0.0012],
        ...,
        [0.0368, 0.0126, 0.0176,  ..., 0.0121, 0.0006, 0.0014],
        [0.0154, 0.0388, 0.0146,  ..., 0.0173, 0.0109, 0.0006],
        [0.0273, 0.0144, 0.0019,  ..., 0.0392, 0.0348, 0.0227]],
       device='cuda:0')
W_mask for 0.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([192, 768])
Weight shape for 0.pwconv2: torch.Size([192, 768])
Non-zero weights for 0.pwconv2 after pruning: 147456
Layer: 1.pwconv1, Metric before mask: tensor([[0.0047, 0.0266, 0.0029,  ..., 0.0280, 0.0106, 0.0206],
        [0.0249, 0.0065, 0.0278,  ..., 0.0182, 0.0160, 0.0009],
        [0.0244, 0.0049, 0.0284,  ..., 0.0231, 0.0047, 0.0135],
        ...,
        [0.0017, 0.0053, 0.0042,  ..., 0.0431, 0.0046, 0.0256],
        [0.0166, 0.0089, 0.0202,  ..., 0.0265, 0.0108, 0.0267],
        [0.0021, 0.0167, 0.0059,  ..., 0.0228, 0.0319, 0.0009]],
       device='cuda:0')
W_mask for 1.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([768, 192])
Weight shape for 1.pwconv1: torch.Size([768, 192])
Non-zero weights for 1.pwconv1 after pruning: 147456
Layer: 1.pwconv2, Metric before mask: tensor([[0.0312, 0.0269, 0.0172,  ..., 0.0011, 0.0139, 0.0141],
        [0.0130, 0.0335, 0.0142,  ..., 0.0400, 0.0040, 0.0055],
        [0.0143, 0.0220, 0.0090,  ..., 0.0149, 0.0187, 0.0154],
        ...,
        [0.0223, 0.0024, 0.0075,  ..., 0.0108, 0.0058, 0.0079],
        [0.0206, 0.0292, 0.0201,  ..., 0.0186, 0.0038, 0.0094],
        [0.0273, 0.0166, 0.0040,  ..., 0.0153, 0.0153, 0.0304]],
       device='cuda:0')
W_mask for 1.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([192, 768])
Weight shape for 1.pwconv2: torch.Size([192, 768])
Non-zero weights for 1.pwconv2 after pruning: 147456
Layer: 2.pwconv1, Metric before mask: tensor([[0.0179, 0.0018, 0.0505,  ..., 0.0493, 0.0106, 0.0146],
        [0.0021, 0.0076, 0.0146,  ..., 0.0170, 0.0316, 0.0090],
        [0.0201, 0.0274, 0.0038,  ..., 0.0268, 0.0161, 0.0064],
        ...,
        [0.0055, 0.0065, 0.0179,  ..., 0.0026, 0.0094, 0.0122],
        [0.0187, 0.0307, 0.0003,  ..., 0.0159, 0.0158, 0.0025],
        [0.0321, 0.0045, 0.0254,  ..., 0.0003, 0.0165, 0.0208]],
       device='cuda:0')
W_mask for 2.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([768, 192])
Weight shape for 2.pwconv1: torch.Size([768, 192])
Non-zero weights for 2.pwconv1 after pruning: 147456
Layer: 2.pwconv2, Metric before mask: tensor([[0.0031, 0.0385, 0.0207,  ..., 0.0026, 0.0115, 0.0032],
        [0.0205, 0.0133, 0.0066,  ..., 0.0375, 0.0089, 0.0173],
        [0.0203, 0.0036, 0.0373,  ..., 0.0134, 0.0228, 0.0032],
        ...,
        [0.0072, 0.0063, 0.0303,  ..., 0.0354, 0.0044, 0.0348],
        [0.0198, 0.0084, 0.0011,  ..., 0.0276, 0.0025, 0.0279],
        [0.0014, 0.0301, 0.0081,  ..., 0.0267, 0.0092, 0.0235]],
       device='cuda:0')
W_mask for 2.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([192, 768])
Weight shape for 2.pwconv2: torch.Size([192, 768])
Non-zero weights for 2.pwconv2 after pruning: 147456
Block 2
Layer: 0.pwconv1, Metric before mask: tensor([[0.0427, 0.0035, 0.0343,  ..., 0.0074, 0.0207, 0.0298],
        [0.0399, 0.0222, 0.0277,  ..., 0.0042, 0.0084, 0.0288],
        [0.0419, 0.0065, 0.0188,  ..., 0.0293, 0.0104, 0.0636],
        ...,
        [0.0373, 0.0189, 0.0061,  ..., 0.0158, 0.0176, 0.0194],
        [0.0248, 0.0047, 0.0014,  ..., 0.0020, 0.0007, 0.0417],
        [0.0127, 0.0070, 0.0119,  ..., 0.0033, 0.0055, 0.0025]],
       device='cuda:0')
W_mask for 0.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 0.pwconv1: torch.Size([1536, 384])
Non-zero weights for 0.pwconv1 after pruning: 589824
Layer: 0.pwconv2, Metric before mask: tensor([[0.0158, 0.0164, 0.0080,  ..., 0.0043, 0.0079, 0.0246],
        [0.0106, 0.0214, 0.0021,  ..., 0.0080, 0.0085, 0.0087],
        [0.0016, 0.0014, 0.0195,  ..., 0.0309, 0.0104, 0.0375],
        ...,
        [0.0029, 0.0169, 0.0256,  ..., 0.0109, 0.0203, 0.0169],
        [0.0179, 0.0095, 0.0406,  ..., 0.0032, 0.0120, 0.0125],
        [0.0305, 0.0022, 0.0228,  ..., 0.0222, 0.0417, 0.0281]],
       device='cuda:0')
W_mask for 0.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 0.pwconv2: torch.Size([384, 1536])
Non-zero weights for 0.pwconv2 after pruning: 589824
Layer: 1.pwconv1, Metric before mask: tensor([[0.0108, 0.0025, 0.0135,  ..., 0.0218, 0.0299, 0.0224],
        [0.0019, 0.0331, 0.0031,  ..., 0.0127, 0.0217, 0.0018],
        [0.0085, 0.0174, 0.0028,  ..., 0.0123, 0.0154, 0.0237],
        ...,
        [0.0310, 0.0123, 0.0007,  ..., 0.0115, 0.0368, 0.0165],
        [0.0151, 0.0254, 0.0037,  ..., 0.0098, 0.0293, 0.0092],
        [0.0151, 0.0137, 0.0049,  ..., 0.0011, 0.0227, 0.0206]],
       device='cuda:0')
W_mask for 1.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 1.pwconv1: torch.Size([1536, 384])
Non-zero weights for 1.pwconv1 after pruning: 589824
Layer: 1.pwconv2, Metric before mask: tensor([[0.0010, 0.0124, 0.0026,  ..., 0.0029, 0.0017, 0.0567],
        [0.0041, 0.0084, 0.0134,  ..., 0.0005, 0.0082, 0.0055],
        [0.0276, 0.0126, 0.0291,  ..., 0.0104, 0.0041, 0.0045],
        ...,
        [0.0108, 0.0041, 0.0048,  ..., 0.0084, 0.0126, 0.0149],
        [0.0080, 0.0292, 0.0157,  ..., 0.0062, 0.0045, 0.0087],
        [0.0139, 0.0139, 0.0071,  ..., 0.0297, 0.0369, 0.0149]],
       device='cuda:0')
W_mask for 1.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 1.pwconv2: torch.Size([384, 1536])
Non-zero weights for 1.pwconv2 after pruning: 589824
Layer: 2.pwconv1, Metric before mask: tensor([[0.0048, 0.0204, 0.0153,  ..., 0.0076, 0.0234, 0.0061],
        [0.0043, 0.0164, 0.0006,  ..., 0.0191, 0.0140, 0.0181],
        [0.0207, 0.0297, 0.0011,  ..., 0.0026, 0.0092, 0.0002],
        ...,
        [0.0429, 0.0217, 0.0213,  ..., 0.0017, 0.0258, 0.0047],
        [0.0047, 0.0043, 0.0002,  ..., 0.0373, 0.0039, 0.0094],
        [0.0218, 0.0227, 0.0328,  ..., 0.0098, 0.0198, 0.0237]],
       device='cuda:0')
W_mask for 2.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 2.pwconv1: torch.Size([1536, 384])
Non-zero weights for 2.pwconv1 after pruning: 589824
Layer: 2.pwconv2, Metric before mask: tensor([[0.0094, 0.0253, 0.0324,  ..., 0.0147, 0.0240, 0.0146],
        [0.0092, 0.0002, 0.0010,  ..., 0.0225, 0.0275, 0.0275],
        [0.0088, 0.0200, 0.0167,  ..., 0.0133, 0.0085, 0.0020],
        ...,
        [0.0042, 0.0038, 0.0197,  ..., 0.0024, 0.0073, 0.0007],
        [0.0160, 0.0039, 0.0079,  ..., 0.0197, 0.0051, 0.0351],
        [0.0109, 0.0214, 0.0077,  ..., 0.0246, 0.0092, 0.0401]],
       device='cuda:0')
W_mask for 2.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 2.pwconv2: torch.Size([384, 1536])
Non-zero weights for 2.pwconv2 after pruning: 589824
Layer: 3.pwconv1, Metric before mask: tensor([[0.0218, 0.0366, 0.0047,  ..., 0.0044, 0.0021, 0.0079],
        [0.0324, 0.0010, 0.0226,  ..., 0.0059, 0.0091, 0.0139],
        [0.0059, 0.0165, 0.0039,  ..., 0.0182, 0.0158, 0.0242],
        ...,
        [0.0387, 0.0014, 0.0081,  ..., 0.0286, 0.0226, 0.0716],
        [0.0120, 0.0097, 0.0398,  ..., 0.0061, 0.0259, 0.0204],
        [0.0177, 0.0154, 0.0045,  ..., 0.0003, 0.0174, 0.0156]],
       device='cuda:0')
W_mask for 3.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 3.pwconv1: torch.Size([1536, 384])
Non-zero weights for 3.pwconv1 after pruning: 589824
Layer: 3.pwconv2, Metric before mask: tensor([[0.0152, 0.0050, 0.0219,  ..., 0.0063, 0.0107, 0.0163],
        [0.0318, 0.0305, 0.0213,  ..., 0.0054, 0.0263, 0.0168],
        [0.0196, 0.0041, 0.0381,  ..., 0.0134, 0.0163, 0.0090],
        ...,
        [0.0059, 0.0285, 0.0147,  ..., 0.0103, 0.0368, 0.0076],
        [0.0130, 0.0279, 0.0396,  ..., 0.0016, 0.0323, 0.0120],
        [0.0062, 0.0086, 0.0046,  ..., 0.0447, 0.0056, 0.0034]],
       device='cuda:0')
W_mask for 3.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 3.pwconv2: torch.Size([384, 1536])
Non-zero weights for 3.pwconv2 after pruning: 589824
Layer: 4.pwconv1, Metric before mask: tensor([[0.0248, 0.0501, 0.0174,  ..., 0.0161, 0.0015, 0.0151],
        [0.0040, 0.0228, 0.0049,  ..., 0.0217, 0.0092, 0.0198],
        [0.0347, 0.0227, 0.0035,  ..., 0.0006, 0.0092, 0.0084],
        ...,
        [0.0036, 0.0085, 0.0135,  ..., 0.0255, 0.0271, 0.0117],
        [0.0215, 0.0083, 0.0324,  ..., 0.0189, 0.0084, 0.0105],
        [0.0053, 0.0065, 0.0140,  ..., 0.0068, 0.0214, 0.0529]],
       device='cuda:0')
W_mask for 4.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 4.pwconv1: torch.Size([1536, 384])
Non-zero weights for 4.pwconv1 after pruning: 589824
Layer: 4.pwconv2, Metric before mask: tensor([[0.0088, 0.0186, 0.0055,  ..., 0.0154, 0.0229, 0.0250],
        [0.0308, 0.0238, 0.0013,  ..., 0.0336, 0.0073, 0.0251],
        [0.0307, 0.0200, 0.0023,  ..., 0.0328, 0.0082, 0.0338],
        ...,
        [0.0072, 0.0035, 0.0047,  ..., 0.0009, 0.0119, 0.0111],
        [0.0166, 0.0313, 0.0192,  ..., 0.0069, 0.0137, 0.0058],
        [0.0165, 0.0071, 0.0060,  ..., 0.0256, 0.0045, 0.0348]],
       device='cuda:0')
W_mask for 4.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 4.pwconv2: torch.Size([384, 1536])
Non-zero weights for 4.pwconv2 after pruning: 589824
Layer: 5.pwconv1, Metric before mask: tensor([[0.0040, 0.0166, 0.0197,  ..., 0.0564, 0.0024, 0.0077],
        [0.0318, 0.0028, 0.0162,  ..., 0.0037, 0.0169, 0.0077],
        [0.0125, 0.0049, 0.0225,  ..., 0.0136, 0.0382, 0.0192],
        ...,
        [0.0240, 0.0166, 0.0006,  ..., 0.0124, 0.0140, 0.0069],
        [0.0345, 0.0056, 0.0296,  ..., 0.0017, 0.0173, 0.0014],
        [0.0225, 0.0002, 0.0081,  ..., 0.0007, 0.0403, 0.0092]],
       device='cuda:0')
W_mask for 5.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 5.pwconv1: torch.Size([1536, 384])
Non-zero weights for 5.pwconv1 after pruning: 589824
Layer: 5.pwconv2, Metric before mask: tensor([[0.0303, 0.0035, 0.0166,  ..., 0.0100, 0.0026, 0.0011],
        [0.0067, 0.0094, 0.0007,  ..., 0.0163, 0.0038, 0.0017],
        [0.0094, 0.0151, 0.0184,  ..., 0.0077, 0.0117, 0.0199],
        ...,
        [0.0018, 0.0201, 0.0067,  ..., 0.0010, 0.0164, 0.0197],
        [0.0299, 0.0219, 0.0069,  ..., 0.0289, 0.0055, 0.0331],
        [0.0208, 0.0235, 0.0238,  ..., 0.0074, 0.0184, 0.0377]],
       device='cuda:0')
W_mask for 5.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 5.pwconv2: torch.Size([384, 1536])
Non-zero weights for 5.pwconv2 after pruning: 589823
Layer: 6.pwconv1, Metric before mask: tensor([[0.0194, 0.0133, 0.0062,  ..., 0.0274, 0.0186, 0.0207],
        [0.0246, 0.0147, 0.0009,  ..., 0.0405, 0.0068, 0.0325],
        [0.0035, 0.0130, 0.0133,  ..., 0.0145, 0.0057, 0.0060],
        ...,
        [0.0247, 0.0062, 0.0120,  ..., 0.0167, 0.0036, 0.0394],
        [0.0265, 0.0366, 0.0169,  ..., 0.0260, 0.0341, 0.0071],
        [0.0257, 0.0128, 0.0038,  ..., 0.0191, 0.0039, 0.0316]],
       device='cuda:0')
W_mask for 6.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 6.pwconv1: torch.Size([1536, 384])
Non-zero weights for 6.pwconv1 after pruning: 589823
Layer: 6.pwconv2, Metric before mask: tensor([[0.0086, 0.0184, 0.0175,  ..., 0.0049, 0.0283, 0.0092],
        [0.0128, 0.0125, 0.0486,  ..., 0.0255, 0.0157, 0.0180],
        [0.0301, 0.0273, 0.0098,  ..., 0.0121, 0.0082, 0.0277],
        ...,
        [0.0115, 0.0089, 0.0083,  ..., 0.0003, 0.0054, 0.0084],
        [0.0269, 0.0221, 0.0072,  ..., 0.0159, 0.0530, 0.0121],
        [0.0094, 0.0198, 0.0257,  ..., 0.0143, 0.0360, 0.0165]],
       device='cuda:0')
W_mask for 6.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 6.pwconv2: torch.Size([384, 1536])
Non-zero weights for 6.pwconv2 after pruning: 589824
Layer: 7.pwconv1, Metric before mask: tensor([[0.0201, 0.0133, 0.0443,  ..., 0.0115, 0.0029, 0.0259],
        [0.0155, 0.0006, 0.0140,  ..., 0.0010, 0.0280, 0.0152],
        [0.0080, 0.0283, 0.0061,  ..., 0.0286, 0.0065, 0.0054],
        ...,
        [0.0088, 0.0022, 0.0404,  ..., 0.0028, 0.0015, 0.0322],
        [0.0019, 0.0153, 0.0132,  ..., 0.0152, 0.0112, 0.0030],
        [0.0221, 0.0036, 0.0258,  ..., 0.0066, 0.0136, 0.0374]],
       device='cuda:0')
W_mask for 7.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 7.pwconv1: torch.Size([1536, 384])
Non-zero weights for 7.pwconv1 after pruning: 589824
Layer: 7.pwconv2, Metric before mask: tensor([[0.0041, 0.0187, 0.0058,  ..., 0.0069, 0.0043, 0.0098],
        [0.0027, 0.0061, 0.0031,  ..., 0.0176, 0.0357, 0.0268],
        [0.0225, 0.0249, 0.0226,  ..., 0.0396, 0.0163, 0.0082],
        ...,
        [0.0296, 0.0134, 0.0041,  ..., 0.0009, 0.0045, 0.0271],
        [0.0177, 0.0015, 0.0037,  ..., 0.0205, 0.0022, 0.0118],
        [0.0032, 0.0149, 0.0021,  ..., 0.0248, 0.0087, 0.0034]],
       device='cuda:0')
W_mask for 7.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 7.pwconv2: torch.Size([384, 1536])
Non-zero weights for 7.pwconv2 after pruning: 589824
Layer: 8.pwconv1, Metric before mask: tensor([[2.4981e-02, 2.0702e-02, 1.2579e-02,  ..., 2.3588e-02, 4.1154e-02,
         1.1476e-02],
        [1.0511e-02, 1.4859e-03, 2.9824e-02,  ..., 2.3437e-02, 3.7842e-02,
         6.9899e-03],
        [8.5693e-03, 1.1847e-02, 4.7139e-03,  ..., 1.8734e-02, 2.1147e-02,
         1.1010e-02],
        ...,
        [6.0453e-03, 9.1070e-05, 7.0470e-03,  ..., 1.8422e-02, 4.3143e-02,
         8.9435e-03],
        [5.5570e-04, 1.9786e-02, 8.1251e-04,  ..., 2.1811e-02, 9.4211e-03,
         2.1583e-02],
        [1.1460e-02, 2.2542e-02, 2.2692e-02,  ..., 4.0599e-02, 2.2519e-02,
         8.0431e-03]], device='cuda:0')
W_mask for 8.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 8.pwconv1: torch.Size([1536, 384])
Non-zero weights for 8.pwconv1 after pruning: 589824
Layer: 8.pwconv2, Metric before mask: tensor([[0.0212, 0.0179, 0.0039,  ..., 0.0158, 0.0147, 0.0097],
        [0.0049, 0.0149, 0.0034,  ..., 0.0186, 0.0213, 0.0119],
        [0.0273, 0.0088, 0.0124,  ..., 0.0310, 0.0217, 0.0215],
        ...,
        [0.0068, 0.0266, 0.0259,  ..., 0.0343, 0.0257, 0.0008],
        [0.0310, 0.0374, 0.0311,  ..., 0.0271, 0.0212, 0.0009],
        [0.0425, 0.0163, 0.0134,  ..., 0.0021, 0.0061, 0.0280]],
       device='cuda:0')
W_mask for 8.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 8.pwconv2: torch.Size([384, 1536])
Non-zero weights for 8.pwconv2 after pruning: 589824
Block 3
Layer: 0.pwconv1, Metric before mask: tensor([[0.0119, 0.0043, 0.0164,  ..., 0.0006, 0.0062, 0.0139],
        [0.0005, 0.0043, 0.0086,  ..., 0.0277, 0.0006, 0.0138],
        [0.0176, 0.0273, 0.0102,  ..., 0.0174, 0.0221, 0.0236],
        ...,
        [0.0181, 0.0089, 0.0183,  ..., 0.0293, 0.0024, 0.0267],
        [0.0006, 0.0447, 0.0039,  ..., 0.0180, 0.0287, 0.0192],
        [0.0140, 0.0205, 0.0029,  ..., 0.0086, 0.0103, 0.0320]],
       device='cuda:0')
W_mask for 0.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([3072, 768])
Weight shape for 0.pwconv1: torch.Size([3072, 768])
Non-zero weights for 0.pwconv1 after pruning: 2359296
Layer: 0.pwconv2, Metric before mask: tensor([[2.4632e-02, 6.1188e-03, 1.0006e-02,  ..., 1.4805e-02, 1.9204e-02,
         3.3860e-02],
        [3.0426e-03, 2.5982e-02, 7.1569e-03,  ..., 2.5454e-03, 1.6056e-02,
         3.8431e-02],
        [2.8098e-02, 1.6752e-02, 3.0282e-02,  ..., 1.8276e-02, 1.1781e-02,
         3.1222e-02],
        ...,
        [4.4136e-03, 2.5553e-04, 3.4121e-02,  ..., 2.3373e-02, 2.3896e-02,
         1.5356e-02],
        [1.6812e-02, 2.4693e-02, 2.9405e-02,  ..., 2.3941e-02, 1.4235e-02,
         8.4098e-05],
        [1.3057e-02, 2.5333e-02, 1.0139e-02,  ..., 1.2416e-02, 3.6641e-02,
         2.6809e-03]], device='cuda:0')
W_mask for 0.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([768, 3072])
Weight shape for 0.pwconv2: torch.Size([768, 3072])
Non-zero weights for 0.pwconv2 after pruning: 2359296
Layer: 1.pwconv1, Metric before mask: tensor([[0.0088, 0.0172, 0.0011,  ..., 0.0035, 0.0046, 0.0048],
        [0.0215, 0.0055, 0.0102,  ..., 0.0153, 0.0113, 0.0122],
        [0.0155, 0.0034, 0.0238,  ..., 0.0030, 0.0117, 0.0391],
        ...,
        [0.0245, 0.0270, 0.0168,  ..., 0.0099, 0.0103, 0.0273],
        [0.0204, 0.0229, 0.0001,  ..., 0.0035, 0.0145, 0.0105],
        [0.0093, 0.0006, 0.0309,  ..., 0.0250, 0.0094, 0.0224]],
       device='cuda:0')
W_mask for 1.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([3072, 768])
Weight shape for 1.pwconv1: torch.Size([3072, 768])
Non-zero weights for 1.pwconv1 after pruning: 2359296
Layer: 1.pwconv2, Metric before mask: tensor([[0.0031, 0.0002, 0.0221,  ..., 0.0184, 0.0138, 0.0337],
        [0.0472, 0.0107, 0.0432,  ..., 0.0110, 0.0141, 0.0194],
        [0.0092, 0.0056, 0.0089,  ..., 0.0321, 0.0242, 0.0287],
        ...,
        [0.0466, 0.0132, 0.0252,  ..., 0.0023, 0.0033, 0.0094],
        [0.0208, 0.0117, 0.0112,  ..., 0.0227, 0.0224, 0.0104],
        [0.0049, 0.0033, 0.0274,  ..., 0.0143, 0.0322, 0.0013]],
       device='cuda:0')
W_mask for 1.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([768, 3072])
Weight shape for 1.pwconv2: torch.Size([768, 3072])
Non-zero weights for 1.pwconv2 after pruning: 2359296
Layer: 2.pwconv1, Metric before mask: tensor([[0.0179, 0.0116, 0.0003,  ..., 0.0013, 0.0126, 0.0296],
        [0.0242, 0.0301, 0.0230,  ..., 0.0215, 0.0319, 0.0111],
        [0.0208, 0.0184, 0.0005,  ..., 0.0211, 0.0153, 0.0031],
        ...,
        [0.0237, 0.0334, 0.0042,  ..., 0.0179, 0.0030, 0.0211],
        [0.0054, 0.0029, 0.0359,  ..., 0.0133, 0.0004, 0.0187],
        [0.0047, 0.0587, 0.0102,  ..., 0.0178, 0.0287, 0.0116]],
       device='cuda:0')
W_mask for 2.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([3072, 768])
Weight shape for 2.pwconv1: torch.Size([3072, 768])
Non-zero weights for 2.pwconv1 after pruning: 2359295
Layer: 2.pwconv2, Metric before mask: tensor([[0.0229, 0.0232, 0.0277,  ..., 0.0256, 0.0184, 0.0081],
        [0.0016, 0.0126, 0.0024,  ..., 0.0178, 0.0115, 0.0253],
        [0.0218, 0.0063, 0.0033,  ..., 0.0084, 0.0380, 0.0069],
        ...,
        [0.0167, 0.0243, 0.0319,  ..., 0.0016, 0.0191, 0.0123],
        [0.0216, 0.0145, 0.0020,  ..., 0.0346, 0.0348, 0.0261],
        [0.0266, 0.0049, 0.0378,  ..., 0.0298, 0.0358, 0.0122]],
       device='cuda:0')
W_mask for 2.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([768, 3072])
Weight shape for 2.pwconv2: torch.Size([768, 3072])
Non-zero weights for 2.pwconv2 after pruning: 2359296
Actual sparsity after pruning: 0.00176105406222953
/home/shahanahmed/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 10 worker processes in total. Our suggested max number of worker in current system is 8, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Epoch: [0]  [  0/176]  eta: 0:48:27  lr: 0.000000  min_lr: 0.000000  loss: 7.0318 (7.0318)  class_acc: 0.0000 (0.0000)  weight_decay: 0.0500 (0.0500)  time: 16.5211  data: 3.1881  max mem: 1586
Epoch: [0]  [ 10/176]  eta: 0:08:13  lr: 0.000005  min_lr: 0.000005  loss: 7.0350 (7.0322)  class_acc: 0.0000 (0.0000)  weight_decay: 0.0499 (0.0499)  time: 2.9717  data: 0.2942  max mem: 1586
Epoch: [0]  [ 20/176]  eta: 0:06:25  lr: 0.000009  min_lr: 0.000009  loss: 7.0409 (7.0415)  class_acc: 0.0000 (0.0006)  weight_decay: 0.0495 (0.0495)  time: 1.7697  data: 0.0033  max mem: 1586
Epoch: [0]  [ 30/176]  eta: 0:05:29  lr: 0.000014  min_lr: 0.000014  loss: 7.0066 (7.0149)  class_acc: 0.0000 (0.0008)  weight_decay: 0.0482 (0.0488)  time: 1.8672  data: 0.0036  max mem: 1586
Epoch: [0]  [ 40/176]  eta: 0:04:55  lr: 0.000018  min_lr: 0.000018  loss: 6.9359 (6.9916)  class_acc: 0.0000 (0.0010)  weight_decay: 0.0462 (0.0479)  time: 1.8524  data: 0.0052  max mem: 1586
Epoch: [0]  [ 50/176]  eta: 0:04:29  lr: 0.000023  min_lr: 0.000023  loss: 6.8679 (6.9563)  class_acc: 0.0039 (0.0019)  weight_decay: 0.0435 (0.0467)  time: 1.9557  data: 0.0046  max mem: 1586
Epoch: [0]  [ 60/176]  eta: 0:04:09  lr: 0.000027  min_lr: 0.000027  loss: 6.7493 (6.9141)  class_acc: 0.0078 (0.0036)  weight_decay: 0.0402 (0.0454)  time: 2.1139  data: 0.0034  max mem: 1586
Epoch: [0]  [ 70/176]  eta: 0:03:50  lr: 0.000032  min_lr: 0.000032  loss: 6.6214 (6.8617)  class_acc: 0.0117 (0.0061)  weight_decay: 0.0364 (0.0439)  time: 2.2606  data: 0.0037  max mem: 1586
Epoch: [0]  [ 80/176]  eta: 0:03:30  lr: 0.000037  min_lr: 0.000037  loss: 6.4574 (6.7988)  class_acc: 0.0156 (0.0080)  weight_decay: 0.0323 (0.0422)  time: 2.3282  data: 0.0046  max mem: 1586
Epoch: [0]  [ 90/176]  eta: 0:03:10  lr: 0.000041  min_lr: 0.000041  loss: 6.2067 (6.7211)  class_acc: 0.0195 (0.0091)  weight_decay: 0.0279 (0.0404)  time: 2.3462  data: 0.0042  max mem: 1586
Epoch: [0]  [100/176]  eta: 0:02:49  lr: 0.000046  min_lr: 0.000046  loss: 5.9911 (6.6322)  class_acc: 0.0195 (0.0105)  weight_decay: 0.0234 (0.0385)  time: 2.3467  data: 0.0041  max mem: 1586
Epoch: [0]  [110/176]  eta: 0:02:27  lr: 0.000050  min_lr: 0.000050  loss: 5.6179 (6.5322)  class_acc: 0.0195 (0.0114)  weight_decay: 0.0190 (0.0366)  time: 2.3459  data: 0.0043  max mem: 1586
Epoch: [0]  [120/176]  eta: 0:02:05  lr: 0.000055  min_lr: 0.000055  loss: 5.3509 (6.4230)  class_acc: 0.0195 (0.0124)  weight_decay: 0.0148 (0.0347)  time: 2.3461  data: 0.0042  max mem: 1586
Epoch: [0]  [130/176]  eta: 0:01:43  lr: 0.000059  min_lr: 0.000059  loss: 4.9342 (6.3050)  class_acc: 0.0273 (0.0138)  weight_decay: 0.0109 (0.0327)  time: 2.3465  data: 0.0044  max mem: 1586
Epoch: [0]  [140/176]  eta: 0:01:21  lr: 0.000064  min_lr: 0.000064  loss: 4.7678 (6.1904)  class_acc: 0.0312 (0.0147)  weight_decay: 0.0074 (0.0308)  time: 2.3442  data: 0.0039  max mem: 1586
Epoch: [0]  [150/176]  eta: 0:00:58  lr: 0.000069  min_lr: 0.000069  loss: 4.6441 (6.0860)  class_acc: 0.0234 (0.0157)  weight_decay: 0.0045 (0.0290)  time: 2.3456  data: 0.0036  max mem: 1586
Epoch: [0]  [160/176]  eta: 0:00:36  lr: 0.000073  min_lr: 0.000073  loss: 4.5958 (5.9930)  class_acc: 0.0273 (0.0165)  weight_decay: 0.0023 (0.0273)  time: 2.3521  data: 0.0061  max mem: 1586
Epoch: [0]  [170/176]  eta: 0:00:13  lr: 0.000078  min_lr: 0.000078  loss: 4.5810 (5.9097)  class_acc: 0.0273 (0.0174)  weight_decay: 0.0008 (0.0257)  time: 2.3724  data: 0.0067  max mem: 1586
Epoch: [0]  [175/176]  eta: 0:00:02  lr: 0.000080  min_lr: 0.000080  loss: 4.5768 (5.8784)  class_acc: 0.0312 (0.0179)  weight_decay: 0.0004 (0.0251)  time: 2.2532  data: 0.0055  max mem: 1586
Epoch: [0] Total time: 0:06:39 (2.2676 s / it)
Averaged stats: lr: 0.000080  min_lr: 0.000080  loss: 4.5768 (5.8784)  class_acc: 0.0312 (0.0179)  weight_decay: 0.0004 (0.0251)
/home/shahanahmed/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 10 worker processes in total. Our suggested max number of worker in current system is 8, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Test:  [  0/176]  eta: 0:06:37  loss: 4.5309 (4.5309)  acc1: 3.9062 (3.9062)  acc5: 13.6719 (13.6719)  time: 2.2580  data: 1.6763  max mem: 1586
Test:  [ 10/176]  eta: 0:01:59  loss: 4.5488 (4.5479)  acc1: 3.9062 (3.8352)  acc5: 12.5000 (12.5355)  time: 0.7180  data: 0.1745  max mem: 1586
Test:  [ 20/176]  eta: 0:01:44  loss: 4.5461 (4.5437)  acc1: 3.5156 (3.5900)  acc5: 12.5000 (13.0022)  time: 0.5894  data: 0.0151  max mem: 1586
Test:  [ 30/176]  eta: 0:01:35  loss: 4.5559 (4.5525)  acc1: 3.5156 (3.4022)  acc5: 12.1094 (12.6764)  time: 0.6149  data: 0.0059  max mem: 1586
Test:  [ 40/176]  eta: 0:01:27  loss: 4.5735 (4.5567)  acc1: 3.5156 (3.4775)  acc5: 11.3281 (12.5381)  time: 0.6142  data: 0.0056  max mem: 1586
Test:  [ 50/176]  eta: 0:01:20  loss: 4.5588 (4.5557)  acc1: 3.5156 (3.5692)  acc5: 12.1094 (12.5077)  time: 0.6123  data: 0.0046  max mem: 1586
Test:  [ 60/176]  eta: 0:01:13  loss: 4.5476 (4.5555)  acc1: 3.5156 (3.5605)  acc5: 12.8906 (12.5576)  time: 0.6100  data: 0.0032  max mem: 1586
Test:  [ 70/176]  eta: 0:01:04  loss: 4.5322 (4.5530)  acc1: 3.5156 (3.6147)  acc5: 12.8906 (12.6981)  time: 0.5415  data: 0.0043  max mem: 1586
Test:  [ 80/176]  eta: 0:00:57  loss: 4.5320 (4.5509)  acc1: 3.1250 (3.5687)  acc5: 12.8906 (12.6977)  time: 0.4879  data: 0.0072  max mem: 1586
Test:  [ 90/176]  eta: 0:00:51  loss: 4.5336 (4.5497)  acc1: 3.5156 (3.6229)  acc5: 12.8906 (12.7361)  time: 0.5604  data: 0.0082  max mem: 1586
Test:  [100/176]  eta: 0:00:44  loss: 4.5452 (4.5511)  acc1: 3.9062 (3.5814)  acc5: 12.5000 (12.7282)  time: 0.5287  data: 0.0075  max mem: 1586
Test:  [110/176]  eta: 0:00:38  loss: 4.5506 (4.5498)  acc1: 3.5156 (3.5966)  acc5: 12.8906 (12.8273)  time: 0.5264  data: 0.0064  max mem: 1586
Test:  [120/176]  eta: 0:00:31  loss: 4.5431 (4.5494)  acc1: 3.5156 (3.5899)  acc5: 13.2812 (12.8519)  time: 0.4995  data: 0.0065  max mem: 1586
Test:  [130/176]  eta: 0:00:26  loss: 4.5463 (4.5493)  acc1: 3.5156 (3.5693)  acc5: 13.2812 (12.8608)  time: 0.4896  data: 0.0056  max mem: 1586
Test:  [140/176]  eta: 0:00:20  loss: 4.5470 (4.5498)  acc1: 3.1250 (3.5683)  acc5: 12.5000 (12.8186)  time: 0.5432  data: 0.0050  max mem: 1586
Test:  [150/176]  eta: 0:00:14  loss: 4.5489 (4.5493)  acc1: 3.1250 (3.5570)  acc5: 12.8906 (12.8570)  time: 0.5512  data: 0.0049  max mem: 1586
Test:  [160/176]  eta: 0:00:08  loss: 4.5489 (4.5497)  acc1: 3.1250 (3.5350)  acc5: 12.5000 (12.7960)  time: 0.5101  data: 0.0038  max mem: 1586
Test:  [170/176]  eta: 0:00:03  loss: 4.5512 (4.5491)  acc1: 3.1250 (3.5293)  acc5: 12.1094 (12.7993)  time: 0.5103  data: 0.0039  max mem: 1586
Test:  [175/176]  eta: 0:00:00  loss: 4.5487 (4.5494)  acc1: 2.7344 (3.5089)  acc5: 11.7188 (12.7667)  time: 0.6171  data: 0.0035  max mem: 1586
Test: Total time: 0:01:40 (0.5709 s / it)
* Acc@1 3.509 Acc@5 12.767 loss 4.549
Test:  [ 0/59]  eta: 0:01:18  loss: 3.8223 (3.8223)  acc1: 21.8750 (21.8750)  acc5: 55.8594 (55.8594)  time: 1.3377  data: 1.1291  max mem: 1586
Test:  [10/59]  eta: 0:00:30  loss: 4.4744 (4.4198)  acc1: 1.5625 (4.8295)  acc5: 11.7188 (17.7557)  time: 0.6254  data: 0.1149  max mem: 1586
Test:  [20/59]  eta: 0:00:20  loss: 4.4356 (4.4057)  acc1: 1.5625 (7.3103)  acc5: 12.8906 (21.2798)  time: 0.4831  data: 0.0082  max mem: 1586
Test:  [30/59]  eta: 0:00:15  loss: 4.4041 (4.4086)  acc1: 1.1719 (6.5776)  acc5: 14.4531 (19.4934)  time: 0.4989  data: 0.0038  max mem: 1586
Test:  [40/59]  eta: 0:00:09  loss: 4.4267 (4.3903)  acc1: 1.1719 (7.2218)  acc5: 14.4531 (21.0461)  time: 0.5225  data: 0.0047  max mem: 1586
Test:  [50/59]  eta: 0:00:04  loss: 4.4270 (4.4045)  acc1: 1.1719 (6.5794)  acc5: 14.8438 (19.9755)  time: 0.4461  data: 0.0044  max mem: 1586
Test:  [58/59]  eta: 0:00:00  loss: 4.4270 (4.4020)  acc1: 0.7812 (6.3348)  acc5: 14.4531 (20.4076)  time: 0.5443  data: 0.0042  max mem: 1586
Test: Total time: 0:00:31 (0.5313 s / it)
* Acc@1 6.335 Acc@5 20.408 loss 4.402
Epoch 0: Training Error = 100.00%, Testing Error = 100.00%

Current sparsity level: 1.0493499486937832e-07
Block 0
Layer: 0.pwconv1, Metric before mask: tensor([[0.0053, 0.0422, 0.0178,  ..., 0.0019, 0.0159, 0.0061],
        [0.0269, 0.0127, 0.0131,  ..., 0.0153, 0.0058, 0.0037],
        [0.0011, 0.0101, 0.0072,  ..., 0.0060, 0.0030, 0.0083],
        ...,
        [0.0173, 0.0115, 0.0020,  ..., 0.0156, 0.0092, 0.0309],
        [0.0055, 0.0237, 0.0384,  ..., 0.0236, 0.0476, 0.0098],
        [0.0065, 0.0031, 0.0158,  ..., 0.0076, 0.0152, 0.0160]],
       device='cuda:0')
W_mask for 0.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 96])
Weight shape for 0.pwconv1: torch.Size([384, 96])
Non-zero weights for 0.pwconv1 after pruning: 36864
Layer: 0.pwconv2, Metric before mask: tensor([[0.0180, 0.0188, 0.0174,  ..., 0.0011, 0.0034, 0.0225],
        [0.0307, 0.0141, 0.0276,  ..., 0.0027, 0.0260, 0.0012],
        [0.0029, 0.0203, 0.0136,  ..., 0.0291, 0.0141, 0.0535],
        ...,
        [0.0242, 0.0037, 0.0086,  ..., 0.0082, 0.0413, 0.0245],
        [0.0012, 0.0303, 0.0012,  ..., 0.0353, 0.0280, 0.0071],
        [0.0064, 0.0165, 0.0190,  ..., 0.0510, 0.0471, 0.0222]],
       device='cuda:0')
W_mask for 0.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([96, 384])
Weight shape for 0.pwconv2: torch.Size([96, 384])
Non-zero weights for 0.pwconv2 after pruning: 36864
Layer: 1.pwconv1, Metric before mask: tensor([[0.0084, 0.0166, 0.0022,  ..., 0.0063, 0.0073, 0.0480],
        [0.0054, 0.0415, 0.0373,  ..., 0.0012, 0.0429, 0.0213],
        [0.0224, 0.0261, 0.0140,  ..., 0.0509, 0.0055, 0.0006],
        ...,
        [0.0039, 0.0287, 0.0188,  ..., 0.0278, 0.0104, 0.0141],
        [0.0207, 0.0257, 0.0015,  ..., 0.0403, 0.0084, 0.0171],
        [0.0298, 0.0249, 0.0002,  ..., 0.0324, 0.0263, 0.0259]],
       device='cuda:0')
W_mask for 1.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 96])
Weight shape for 1.pwconv1: torch.Size([384, 96])
Non-zero weights for 1.pwconv1 after pruning: 36864
Layer: 1.pwconv2, Metric before mask: tensor([[0.0004, 0.0181, 0.0383,  ..., 0.0021, 0.0138, 0.0104],
        [0.0173, 0.0167, 0.0032,  ..., 0.0180, 0.0231, 0.0086],
        [0.0242, 0.0019, 0.0336,  ..., 0.0125, 0.0007, 0.0019],
        ...,
        [0.0031, 0.0124, 0.0089,  ..., 0.0041, 0.0075, 0.0156],
        [0.0138, 0.0064, 0.0162,  ..., 0.0394, 0.0170, 0.0236],
        [0.0309, 0.0263, 0.0149,  ..., 0.0142, 0.0131, 0.0078]],
       device='cuda:0')
W_mask for 1.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([96, 384])
Weight shape for 1.pwconv2: torch.Size([96, 384])
Non-zero weights for 1.pwconv2 after pruning: 36864
Layer: 2.pwconv1, Metric before mask: tensor([[0.0273, 0.0190, 0.0178,  ..., 0.0261, 0.0512, 0.0197],
        [0.0166, 0.0141, 0.0090,  ..., 0.0296, 0.0324, 0.0026],
        [0.0052, 0.0048, 0.0091,  ..., 0.0140, 0.0072, 0.0467],
        ...,
        [0.0280, 0.0134, 0.0071,  ..., 0.0144, 0.0341, 0.0216],
        [0.0068, 0.0084, 0.0416,  ..., 0.0006, 0.0191, 0.0021],
        [0.0084, 0.0141, 0.0018,  ..., 0.0022, 0.0095, 0.0059]],
       device='cuda:0')
W_mask for 2.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 96])
Weight shape for 2.pwconv1: torch.Size([384, 96])
Non-zero weights for 2.pwconv1 after pruning: 36864
Layer: 2.pwconv2, Metric before mask: tensor([[0.0082, 0.0208, 0.0315,  ..., 0.0154, 0.0021, 0.0567],
        [0.0210, 0.0175, 0.0453,  ..., 0.0250, 0.0181, 0.0208],
        [0.0052, 0.0119, 0.0181,  ..., 0.0215, 0.0008, 0.0048],
        ...,
        [0.0123, 0.0214, 0.0050,  ..., 0.0153, 0.0294, 0.0032],
        [0.0312, 0.0288, 0.0219,  ..., 0.0108, 0.0132, 0.0115],
        [0.0101, 0.0296, 0.0116,  ..., 0.0398, 0.0051, 0.0070]],
       device='cuda:0')
W_mask for 2.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([96, 384])
Weight shape for 2.pwconv2: torch.Size([96, 384])
Non-zero weights for 2.pwconv2 after pruning: 36864
Block 1
Layer: 0.pwconv1, Metric before mask: tensor([[0.0057, 0.0194, 0.0088,  ..., 0.0101, 0.0160, 0.0184],
        [0.0316, 0.0046, 0.0093,  ..., 0.0522, 0.0042, 0.0186],
        [0.0034, 0.0028, 0.0324,  ..., 0.0025, 0.0077, 0.0057],
        ...,
        [0.0249, 0.0278, 0.0134,  ..., 0.0092, 0.0332, 0.0105],
        [0.0107, 0.0288, 0.0268,  ..., 0.0087, 0.0006, 0.0421],
        [0.0020, 0.0165, 0.0227,  ..., 0.0267, 0.0070, 0.0146]],
       device='cuda:0')
W_mask for 0.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([768, 192])
Weight shape for 0.pwconv1: torch.Size([768, 192])
Non-zero weights for 0.pwconv1 after pruning: 147456
Layer: 0.pwconv2, Metric before mask: tensor([[7.3771e-03, 4.6532e-02, 2.8138e-02,  ..., 1.0026e-02, 9.1482e-03,
         3.0479e-02],
        [1.9789e-02, 8.3137e-03, 1.1062e-02,  ..., 5.1343e-03, 3.1698e-05,
         3.7296e-02],
        [3.2877e-02, 1.7291e-02, 3.6548e-02,  ..., 8.4748e-03, 4.4168e-03,
         2.4254e-03],
        ...,
        [4.0560e-02, 1.7528e-02, 1.9102e-02,  ..., 1.2388e-02, 3.8653e-03,
         9.2953e-04],
        [2.1263e-02, 3.4160e-02, 9.1106e-03,  ..., 9.7929e-03, 4.4981e-03,
         4.6382e-03],
        [3.4411e-02, 2.0375e-02, 7.6026e-03,  ..., 3.2530e-02, 4.2591e-02,
         2.8601e-02]], device='cuda:0')
W_mask for 0.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([192, 768])
Weight shape for 0.pwconv2: torch.Size([192, 768])
Non-zero weights for 0.pwconv2 after pruning: 147456
Layer: 1.pwconv1, Metric before mask: tensor([[0.0061, 0.0304, 0.0111,  ..., 0.0224, 0.0150, 0.0145],
        [0.0239, 0.0039, 0.0276,  ..., 0.0199, 0.0110, 0.0023],
        [0.0282, 0.0064, 0.0218,  ..., 0.0183, 0.0101, 0.0163],
        ...,
        [0.0090, 0.0125, 0.0133,  ..., 0.0515, 0.0090, 0.0182],
        [0.0203, 0.0146, 0.0165,  ..., 0.0209, 0.0175, 0.0320],
        [0.0047, 0.0112, 0.0130,  ..., 0.0302, 0.0281, 0.0065]],
       device='cuda:0')
W_mask for 1.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([768, 192])
Weight shape for 1.pwconv1: torch.Size([768, 192])
Non-zero weights for 1.pwconv1 after pruning: 147456
Layer: 1.pwconv2, Metric before mask: tensor([[0.0379, 0.0197, 0.0117,  ..., 0.0084, 0.0194, 0.0062],
        [0.0075, 0.0278, 0.0154,  ..., 0.0348, 0.0031, 0.0088],
        [0.0155, 0.0235, 0.0085,  ..., 0.0144, 0.0177, 0.0140],
        ...,
        [0.0268, 0.0050, 0.0043,  ..., 0.0150, 0.0052, 0.0049],
        [0.0260, 0.0342, 0.0162,  ..., 0.0258, 0.0102, 0.0031],
        [0.0206, 0.0098, 0.0012,  ..., 0.0232, 0.0207, 0.0382]],
       device='cuda:0')
W_mask for 1.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([192, 768])
Weight shape for 1.pwconv2: torch.Size([192, 768])
Non-zero weights for 1.pwconv2 after pruning: 147456
Layer: 2.pwconv1, Metric before mask: tensor([[0.0123, 0.0091, 0.0448,  ..., 0.0567, 0.0090, 0.0070],
        [0.0007, 0.0092, 0.0104,  ..., 0.0172, 0.0315, 0.0065],
        [0.0252, 0.0273, 0.0016,  ..., 0.0251, 0.0143, 0.0008],
        ...,
        [0.0042, 0.0126, 0.0169,  ..., 0.0009, 0.0088, 0.0190],
        [0.0218, 0.0381, 0.0065,  ..., 0.0228, 0.0143, 0.0089],
        [0.0260, 0.0094, 0.0203,  ..., 0.0007, 0.0221, 0.0290]],
       device='cuda:0')
W_mask for 2.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([768, 192])
Weight shape for 2.pwconv1: torch.Size([768, 192])
Non-zero weights for 2.pwconv1 after pruning: 147456
Layer: 2.pwconv2, Metric before mask: tensor([[1.0233e-02, 4.0143e-02, 1.3738e-02,  ..., 4.6018e-03, 5.6567e-03,
         7.5277e-03],
        [1.5976e-02, 1.2098e-02, 9.7327e-03,  ..., 4.0465e-02, 1.2810e-02,
         2.2913e-02],
        [1.7083e-02, 5.1415e-03, 3.4924e-02,  ..., 1.1489e-02, 1.9070e-02,
         8.2388e-03],
        ...,
        [3.9295e-03, 7.6634e-03, 3.3219e-02,  ..., 3.1960e-02, 1.6797e-03,
         3.2637e-02],
        [1.5280e-02, 9.1604e-03, 4.7885e-03,  ..., 3.2754e-02, 1.4284e-03,
         2.3388e-02],
        [3.9753e-03, 3.3066e-02, 5.3493e-05,  ..., 3.4203e-02, 1.6561e-02,
         1.7988e-02]], device='cuda:0')
W_mask for 2.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([192, 768])
Weight shape for 2.pwconv2: torch.Size([192, 768])
Non-zero weights for 2.pwconv2 after pruning: 147456
Block 2
Layer: 0.pwconv1, Metric before mask: tensor([[0.0414, 0.0069, 0.0357,  ..., 0.0059, 0.0178, 0.0309],
        [0.0404, 0.0251, 0.0278,  ..., 0.0032, 0.0093, 0.0249],
        [0.0437, 0.0106, 0.0195,  ..., 0.0249, 0.0149, 0.0566],
        ...,
        [0.0326, 0.0136, 0.0065,  ..., 0.0214, 0.0225, 0.0169],
        [0.0254, 0.0008, 0.0031,  ..., 0.0017, 0.0038, 0.0386],
        [0.0080, 0.0042, 0.0111,  ..., 0.0044, 0.0071, 0.0010]],
       device='cuda:0')
W_mask for 0.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 0.pwconv1: torch.Size([1536, 384])
Non-zero weights for 0.pwconv1 after pruning: 589824
Layer: 0.pwconv2, Metric before mask: tensor([[0.0143, 0.0166, 0.0087,  ..., 0.0080, 0.0087, 0.0225],
        [0.0160, 0.0237, 0.0026,  ..., 0.0121, 0.0057, 0.0047],
        [0.0071, 0.0003, 0.0213,  ..., 0.0381, 0.0160, 0.0413],
        ...,
        [0.0017, 0.0188, 0.0232,  ..., 0.0045, 0.0155, 0.0226],
        [0.0211, 0.0118, 0.0396,  ..., 0.0010, 0.0148, 0.0119],
        [0.0372, 0.0028, 0.0191,  ..., 0.0285, 0.0370, 0.0249]],
       device='cuda:0')
W_mask for 0.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 0.pwconv2: torch.Size([384, 1536])
Non-zero weights for 0.pwconv2 after pruning: 589824
Layer: 1.pwconv1, Metric before mask: tensor([[0.0039, 0.0034, 0.0194,  ..., 0.0189, 0.0379, 0.0298],
        [0.0039, 0.0336, 0.0052,  ..., 0.0138, 0.0218, 0.0017],
        [0.0017, 0.0113, 0.0046,  ..., 0.0086, 0.0094, 0.0177],
        ...,
        [0.0266, 0.0092, 0.0064,  ..., 0.0078, 0.0435, 0.0104],
        [0.0200, 0.0188, 0.0009,  ..., 0.0050, 0.0353, 0.0015],
        [0.0205, 0.0155, 0.0033,  ..., 0.0003, 0.0260, 0.0246]],
       device='cuda:0')
W_mask for 1.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 1.pwconv1: torch.Size([1536, 384])
Non-zero weights for 1.pwconv1 after pruning: 589824
Layer: 1.pwconv2, Metric before mask: tensor([[0.0022, 0.0114, 0.0018,  ..., 0.0041, 0.0022, 0.0575],
        [0.0018, 0.0078, 0.0120,  ..., 0.0028, 0.0109, 0.0022],
        [0.0210, 0.0072, 0.0324,  ..., 0.0036, 0.0117, 0.0115],
        ...,
        [0.0049, 0.0011, 0.0091,  ..., 0.0143, 0.0203, 0.0185],
        [0.0132, 0.0292, 0.0151,  ..., 0.0102, 0.0108, 0.0128],
        [0.0200, 0.0166, 0.0081,  ..., 0.0356, 0.0302, 0.0188]],
       device='cuda:0')
W_mask for 1.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 1.pwconv2: torch.Size([384, 1536])
Non-zero weights for 1.pwconv2 after pruning: 589824
Layer: 2.pwconv1, Metric before mask: tensor([[0.0010, 0.0150, 0.0204,  ..., 0.0019, 0.0276, 0.0104],
        [0.0102, 0.0095, 0.0064,  ..., 0.0127, 0.0181, 0.0241],
        [0.0258, 0.0262, 0.0027,  ..., 0.0073, 0.0061, 0.0060],
        ...,
        [0.0367, 0.0281, 0.0281,  ..., 0.0092, 0.0234, 0.0006],
        [0.0047, 0.0037, 0.0016,  ..., 0.0357, 0.0084, 0.0137],
        [0.0151, 0.0295, 0.0268,  ..., 0.0153, 0.0267, 0.0298]],
       device='cuda:0')
W_mask for 2.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 2.pwconv1: torch.Size([1536, 384])
Non-zero weights for 2.pwconv1 after pruning: 589824
Layer: 2.pwconv2, Metric before mask: tensor([[0.0065, 0.0213, 0.0354,  ..., 0.0104, 0.0249, 0.0185],
        [0.0151, 0.0058, 0.0063,  ..., 0.0175, 0.0309, 0.0330],
        [0.0002, 0.0118, 0.0235,  ..., 0.0214, 0.0131, 0.0105],
        ...,
        [0.0015, 0.0097, 0.0248,  ..., 0.0080, 0.0106, 0.0056],
        [0.0219, 0.0009, 0.0044,  ..., 0.0135, 0.0067, 0.0295],
        [0.0175, 0.0278, 0.0130,  ..., 0.0308, 0.0052, 0.0462]],
       device='cuda:0')
W_mask for 2.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 2.pwconv2: torch.Size([384, 1536])
Non-zero weights for 2.pwconv2 after pruning: 589824
Layer: 3.pwconv1, Metric before mask: tensor([[0.0284, 0.0311, 0.0010,  ..., 0.0024, 0.0085, 0.0136],
        [0.0269, 0.0050, 0.0234,  ..., 0.0130, 0.0143, 0.0085],
        [0.0061, 0.0175, 0.0039,  ..., 0.0193, 0.0146, 0.0272],
        ...,
        [0.0339, 0.0047, 0.0137,  ..., 0.0363, 0.0189, 0.0787],
        [0.0137, 0.0114, 0.0366,  ..., 0.0114, 0.0290, 0.0182],
        [0.0142, 0.0167, 0.0066,  ..., 0.0057, 0.0130, 0.0114]],
       device='cuda:0')
W_mask for 3.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 3.pwconv1: torch.Size([1536, 384])
Non-zero weights for 3.pwconv1 after pruning: 589824
Layer: 3.pwconv2, Metric before mask: tensor([[1.3999e-02, 8.8363e-03, 2.0775e-02,  ..., 9.0586e-03, 1.2172e-02,
         2.0015e-02],
        [2.7881e-02, 3.5135e-02, 2.3892e-02,  ..., 8.2757e-03, 2.8781e-02,
         2.0033e-02],
        [2.6836e-02, 1.2098e-02, 3.5803e-02,  ..., 7.1696e-03, 1.1784e-02,
         1.4726e-02],
        ...,
        [6.6377e-04, 2.1357e-02, 1.1417e-02,  ..., 1.6540e-02, 4.2623e-02,
         1.0566e-03],
        [8.5969e-03, 3.2230e-02, 4.1420e-02,  ..., 6.2883e-03, 3.0270e-02,
         8.1664e-03],
        [1.3713e-02, 1.3890e-02, 7.6177e-05,  ..., 5.0866e-02, 1.7760e-03,
         2.1665e-03]], device='cuda:0')
W_mask for 3.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 3.pwconv2: torch.Size([384, 1536])
Non-zero weights for 3.pwconv2 after pruning: 589824
Layer: 4.pwconv1, Metric before mask: tensor([[0.0314, 0.0460, 0.0138,  ..., 0.0120, 0.0061, 0.0220],
        [0.0032, 0.0164, 0.0060,  ..., 0.0164, 0.0153, 0.0136],
        [0.0406, 0.0268, 0.0086,  ..., 0.0045, 0.0154, 0.0132],
        ...,
        [0.0081, 0.0045, 0.0132,  ..., 0.0305, 0.0318, 0.0170],
        [0.0284, 0.0147, 0.0294,  ..., 0.0243, 0.0146, 0.0166],
        [0.0016, 0.0129, 0.0123,  ..., 0.0106, 0.0255, 0.0593]],
       device='cuda:0')
W_mask for 4.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 4.pwconv1: torch.Size([1536, 384])
Non-zero weights for 4.pwconv1 after pruning: 589824
Layer: 4.pwconv2, Metric before mask: tensor([[0.0063, 0.0185, 0.0063,  ..., 0.0140, 0.0213, 0.0228],
        [0.0354, 0.0302, 0.0028,  ..., 0.0348, 0.0022, 0.0201],
        [0.0382, 0.0269, 0.0084,  ..., 0.0313, 0.0158, 0.0384],
        ...,
        [0.0118, 0.0020, 0.0087,  ..., 0.0023, 0.0056, 0.0166],
        [0.0229, 0.0283, 0.0143,  ..., 0.0070, 0.0090, 0.0088],
        [0.0218, 0.0022, 0.0005,  ..., 0.0255, 0.0096, 0.0303]],
       device='cuda:0')
W_mask for 4.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 4.pwconv2: torch.Size([384, 1536])
Non-zero weights for 4.pwconv2 after pruning: 589824
Layer: 5.pwconv1, Metric before mask: tensor([[0.0010, 0.0131, 0.0129,  ..., 0.0528, 0.0039, 0.0121],
        [0.0253, 0.0100, 0.0233,  ..., 0.0018, 0.0092, 0.0014],
        [0.0074, 0.0088, 0.0162,  ..., 0.0180, 0.0328, 0.0140],
        ...,
        [0.0193, 0.0233, 0.0054,  ..., 0.0176, 0.0216, 0.0047],
        [0.0419, 0.0117, 0.0317,  ..., 0.0090, 0.0224, 0.0086],
        [0.0245, 0.0020, 0.0087,  ..., 0.0005, 0.0404, 0.0086]],
       device='cuda:0')
W_mask for 5.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 5.pwconv1: torch.Size([1536, 384])
Non-zero weights for 5.pwconv1 after pruning: 589824
Layer: 5.pwconv2, Metric before mask: tensor([[0.0323, 0.0023, 0.0152,  ..., 0.0057, 0.0059, 0.0037],
        [0.0057, 0.0113, 0.0002,  ..., 0.0178, 0.0047, 0.0003],
        [0.0015, 0.0213, 0.0214,  ..., 0.0145, 0.0043, 0.0240],
        ...,
        [0.0041, 0.0155, 0.0114,  ..., 0.0045, 0.0224, 0.0237],
        [0.0238, 0.0275, 0.0086,  ..., 0.0255, 0.0095, 0.0353],
        [0.0270, 0.0161, 0.0295,  ..., 0.0129, 0.0243, 0.0364]],
       device='cuda:0')
W_mask for 5.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 5.pwconv2: torch.Size([384, 1536])
Non-zero weights for 5.pwconv2 after pruning: 589823
Layer: 6.pwconv1, Metric before mask: tensor([[2.5019e-02, 1.7832e-02, 2.3924e-04,  ..., 3.2616e-02, 1.4703e-02,
         2.7684e-02],
        [2.9351e-02, 1.1185e-02, 3.2523e-03,  ..., 3.9775e-02, 9.8483e-03,
         2.7368e-02],
        [2.3569e-03, 1.8653e-02, 5.4955e-03,  ..., 1.7804e-02, 6.1154e-05,
         1.3162e-02],
        ...,
        [2.3389e-02, 5.2103e-03, 6.0633e-03,  ..., 2.0156e-02, 1.6927e-03,
         3.4768e-02],
        [3.2387e-02, 4.1586e-02, 2.2303e-02,  ..., 2.5181e-02, 3.2470e-02,
         1.4038e-02],
        [2.2789e-02, 1.1312e-02, 6.0128e-03,  ..., 2.2089e-02, 1.3745e-03,
         3.6372e-02]], device='cuda:0')
W_mask for 6.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 6.pwconv1: torch.Size([1536, 384])
Non-zero weights for 6.pwconv1 after pruning: 589823
Layer: 6.pwconv2, Metric before mask: tensor([[0.0103, 0.0173, 0.0149,  ..., 0.0042, 0.0293, 0.0062],
        [0.0067, 0.0165, 0.0429,  ..., 0.0252, 0.0214, 0.0209],
        [0.0372, 0.0194, 0.0180,  ..., 0.0176, 0.0147, 0.0350],
        ...,
        [0.0174, 0.0153, 0.0019,  ..., 0.0041, 0.0005, 0.0027],
        [0.0323, 0.0157, 0.0135,  ..., 0.0158, 0.0477, 0.0170],
        [0.0159, 0.0160, 0.0300,  ..., 0.0142, 0.0422, 0.0102]],
       device='cuda:0')
W_mask for 6.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 6.pwconv2: torch.Size([384, 1536])
Non-zero weights for 6.pwconv2 after pruning: 589824
Layer: 7.pwconv1, Metric before mask: tensor([[0.0265, 0.0207, 0.0506,  ..., 0.0080, 0.0085, 0.0311],
        [0.0185, 0.0001, 0.0134,  ..., 0.0027, 0.0255, 0.0146],
        [0.0084, 0.0296, 0.0099,  ..., 0.0275, 0.0072, 0.0052],
        ...,
        [0.0153, 0.0045, 0.0384,  ..., 0.0024, 0.0060, 0.0376],
        [0.0006, 0.0179, 0.0113,  ..., 0.0102, 0.0114, 0.0034],
        [0.0298, 0.0038, 0.0186,  ..., 0.0137, 0.0067, 0.0309]],
       device='cuda:0')
W_mask for 7.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 7.pwconv1: torch.Size([1536, 384])
Non-zero weights for 7.pwconv1 after pruning: 589824
Layer: 7.pwconv2, Metric before mask: tensor([[0.0031, 0.0183, 0.0060,  ..., 0.0076, 0.0051, 0.0098],
        [0.0061, 0.0070, 0.0037,  ..., 0.0148, 0.0396, 0.0307],
        [0.0158, 0.0252, 0.0225,  ..., 0.0451, 0.0236, 0.0148],
        ...,
        [0.0229, 0.0124, 0.0042,  ..., 0.0056, 0.0015, 0.0340],
        [0.0207, 0.0011, 0.0040,  ..., 0.0181, 0.0054, 0.0154],
        [0.0081, 0.0134, 0.0009,  ..., 0.0295, 0.0139, 0.0012]],
       device='cuda:0')
W_mask for 7.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 7.pwconv2: torch.Size([384, 1536])
Non-zero weights for 7.pwconv2 after pruning: 589824
Layer: 8.pwconv1, Metric before mask: tensor([[0.0197, 0.0257, 0.0195,  ..., 0.0302, 0.0486, 0.0052],
        [0.0152, 0.0068, 0.0377,  ..., 0.0175, 0.0442, 0.0144],
        [0.0048, 0.0162, 0.0086,  ..., 0.0132, 0.0268, 0.0149],
        ...,
        [0.0028, 0.0015, 0.0106,  ..., 0.0142, 0.0465, 0.0050],
        [0.0016, 0.0163, 0.0009,  ..., 0.0238, 0.0129, 0.0241],
        [0.0131, 0.0287, 0.0170,  ..., 0.0447, 0.0168, 0.0022]],
       device='cuda:0')
W_mask for 8.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 8.pwconv1: torch.Size([1536, 384])
Non-zero weights for 8.pwconv1 after pruning: 589824
Layer: 8.pwconv2, Metric before mask: tensor([[0.0257, 0.0196, 0.0031,  ..., 0.0131, 0.0146, 0.0119],
        [0.0015, 0.0098, 0.0021,  ..., 0.0208, 0.0186, 0.0080],
        [0.0352, 0.0161, 0.0184,  ..., 0.0237, 0.0226, 0.0143],
        ...,
        [0.0003, 0.0193, 0.0228,  ..., 0.0393, 0.0241, 0.0059],
        [0.0260, 0.0319, 0.0256,  ..., 0.0228, 0.0211, 0.0055],
        [0.0472, 0.0225, 0.0070,  ..., 0.0056, 0.0053, 0.0237]],
       device='cuda:0')
W_mask for 8.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 8.pwconv2: torch.Size([384, 1536])
Non-zero weights for 8.pwconv2 after pruning: 589824
Block 3
Layer: 0.pwconv1, Metric before mask: tensor([[0.0068, 0.0005, 0.0233,  ..., 0.0048, 0.0102, 0.0216],
        [0.0073, 0.0084, 0.0013,  ..., 0.0222, 0.0050, 0.0223],
        [0.0116, 0.0241, 0.0084,  ..., 0.0213, 0.0253, 0.0171],
        ...,
        [0.0110, 0.0068, 0.0223,  ..., 0.0238, 0.0018, 0.0338],
        [0.0074, 0.0505, 0.0101,  ..., 0.0112, 0.0353, 0.0112],
        [0.0073, 0.0267, 0.0034,  ..., 0.0011, 0.0032, 0.0241]],
       device='cuda:0')
W_mask for 0.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([3072, 768])
Weight shape for 0.pwconv1: torch.Size([3072, 768])
Non-zero weights for 0.pwconv1 after pruning: 2359296
Layer: 0.pwconv2, Metric before mask: tensor([[0.0213, 0.0106, 0.0133,  ..., 0.0186, 0.0226, 0.0385],
        [0.0076, 0.0312, 0.0112,  ..., 0.0063, 0.0111, 0.0330],
        [0.0310, 0.0200, 0.0280,  ..., 0.0207, 0.0078, 0.0270],
        ...,
        [0.0012, 0.0035, 0.0324,  ..., 0.0266, 0.0266, 0.0170],
        [0.0109, 0.0181, 0.0242,  ..., 0.0187, 0.0083, 0.0067],
        [0.0104, 0.0280, 0.0080,  ..., 0.0103, 0.0332, 0.0056]],
       device='cuda:0')
W_mask for 0.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([768, 3072])
Weight shape for 0.pwconv2: torch.Size([768, 3072])
Non-zero weights for 0.pwconv2 after pruning: 2359296
Layer: 1.pwconv1, Metric before mask: tensor([[0.0012, 0.0247, 0.0086,  ..., 0.0040, 0.0015, 0.0122],
        [0.0248, 0.0084, 0.0062,  ..., 0.0166, 0.0145, 0.0085],
        [0.0223, 0.0025, 0.0309,  ..., 0.0095, 0.0055, 0.0321],
        ...,
        [0.0309, 0.0339, 0.0092,  ..., 0.0165, 0.0026, 0.0189],
        [0.0192, 0.0232, 0.0010,  ..., 0.0048, 0.0139, 0.0100],
        [0.0049, 0.0028, 0.0344,  ..., 0.0206, 0.0117, 0.0178]],
       device='cuda:0')
W_mask for 1.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([3072, 768])
Weight shape for 1.pwconv1: torch.Size([3072, 768])
Non-zero weights for 1.pwconv1 after pruning: 2359296
Layer: 1.pwconv2, Metric before mask: tensor([[0.0086, 0.0032, 0.0276,  ..., 0.0135, 0.0142, 0.0368],
        [0.0523, 0.0115, 0.0488,  ..., 0.0058, 0.0147, 0.0221],
        [0.0124, 0.0054, 0.0119,  ..., 0.0346, 0.0238, 0.0307],
        ...,
        [0.0438, 0.0113, 0.0226,  ..., 0.0017, 0.0023, 0.0112],
        [0.0144, 0.0098, 0.0177,  ..., 0.0293, 0.0218, 0.0069],
        [0.0027, 0.0034, 0.0289,  ..., 0.0121, 0.0316, 0.0008]],
       device='cuda:0')
W_mask for 1.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([768, 3072])
Weight shape for 1.pwconv2: torch.Size([768, 3072])
Non-zero weights for 1.pwconv2 after pruning: 2359296
Layer: 2.pwconv1, Metric before mask: tensor([[0.0235, 0.0055, 0.0061,  ..., 0.0088, 0.0194, 0.0230],
        [0.0296, 0.0365, 0.0167,  ..., 0.0289, 0.0247, 0.0044],
        [0.0190, 0.0154, 0.0014,  ..., 0.0257, 0.0182, 0.0075],
        ...,
        [0.0302, 0.0404, 0.0024,  ..., 0.0252, 0.0037, 0.0286],
        [0.0115, 0.0032, 0.0300,  ..., 0.0208, 0.0077, 0.0263],
        [0.0110, 0.0526, 0.0172,  ..., 0.0105, 0.0361, 0.0190]],
       device='cuda:0')
W_mask for 2.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([3072, 768])
Weight shape for 2.pwconv1: torch.Size([3072, 768])
Non-zero weights for 2.pwconv1 after pruning: 2359295
Layer: 2.pwconv2, Metric before mask: tensor([[0.0177, 0.0177, 0.0246,  ..., 0.0211, 0.0141, 0.0131],
        [0.0064, 0.0078, 0.0034,  ..., 0.0228, 0.0164, 0.0210],
        [0.0206, 0.0093, 0.0037,  ..., 0.0049, 0.0407, 0.0096],
        ...,
        [0.0130, 0.0273, 0.0332,  ..., 0.0046, 0.0162, 0.0149],
        [0.0284, 0.0213, 0.0015,  ..., 0.0411, 0.0282, 0.0321],
        [0.0240, 0.0022, 0.0366,  ..., 0.0317, 0.0329, 0.0110]],
       device='cuda:0')
W_mask for 2.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([768, 3072])
Weight shape for 2.pwconv2: torch.Size([768, 3072])
Non-zero weights for 2.pwconv2 after pruning: 2359296
Actual sparsity after pruning: 1.0493499486937832e-07
Epoch: [0]  [  0/176]  eta: 0:10:54  lr: 0.000000  min_lr: 0.000000  loss: 4.5253 (4.5253)  class_acc: 0.0156 (0.0156)  weight_decay: 0.0500 (0.0500)  time: 3.7212  data: 1.5942  max mem: 1586
Epoch: [0]  [ 10/176]  eta: 0:06:49  lr: 0.000005  min_lr: 0.000005  loss: 4.5546 (4.5526)  class_acc: 0.0312 (0.0348)  weight_decay: 0.0499 (0.0499)  time: 2.4688  data: 0.1490  max mem: 1586
Epoch: [0]  [ 20/176]  eta: 0:06:15  lr: 0.000009  min_lr: 0.000009  loss: 4.5514 (4.5532)  class_acc: 0.0312 (0.0335)  weight_decay: 0.0495 (0.0495)  time: 2.3422  data: 0.0032  max mem: 1586
Epoch: [0]  [ 30/176]  eta: 0:05:57  lr: 0.000014  min_lr: 0.000014  loss: 4.5480 (4.5503)  class_acc: 0.0312 (0.0344)  weight_decay: 0.0482 (0.0488)  time: 2.4326  data: 0.0027  max mem: 1586
Epoch: [0]  [ 40/176]  eta: 0:05:35  lr: 0.000018  min_lr: 0.000018  loss: 4.5278 (4.5440)  class_acc: 0.0312 (0.0354)  weight_decay: 0.0462 (0.0479)  time: 2.5337  data: 0.0034  max mem: 1586
Epoch: [0]  [ 50/176]  eta: 0:05:13  lr: 0.000023  min_lr: 0.000023  loss: 4.5278 (4.5439)  class_acc: 0.0352 (0.0357)  weight_decay: 0.0435 (0.0467)  time: 2.5587  data: 0.0034  max mem: 1586
Epoch: [0]  [ 60/176]  eta: 0:04:52  lr: 0.000027  min_lr: 0.000027  loss: 4.5376 (4.5432)  class_acc: 0.0352 (0.0358)  weight_decay: 0.0402 (0.0454)  time: 2.6260  data: 0.0035  max mem: 1586
Epoch: [0]  [ 70/176]  eta: 0:04:30  lr: 0.000032  min_lr: 0.000032  loss: 4.5252 (4.5389)  class_acc: 0.0391 (0.0374)  weight_decay: 0.0364 (0.0439)  time: 2.7086  data: 0.0037  max mem: 1586
Epoch: [0]  [ 80/176]  eta: 0:04:06  lr: 0.000037  min_lr: 0.000037  loss: 4.5190 (4.5366)  class_acc: 0.0430 (0.0380)  weight_decay: 0.0323 (0.0422)  time: 2.7010  data: 0.0030  max mem: 1586
Epoch: [0]  [ 90/176]  eta: 0:03:41  lr: 0.000041  min_lr: 0.000041  loss: 4.5191 (4.5334)  class_acc: 0.0430 (0.0387)  weight_decay: 0.0279 (0.0404)  time: 2.6805  data: 0.0031  max mem: 1586
Epoch: [0]  [100/176]  eta: 0:03:17  lr: 0.000046  min_lr: 0.000046  loss: 4.4923 (4.5300)  class_acc: 0.0508 (0.0397)  weight_decay: 0.0234 (0.0385)  time: 2.7235  data: 0.0041  max mem: 1586
Epoch: [0]  [110/176]  eta: 0:02:51  lr: 0.000050  min_lr: 0.000050  loss: 4.4858 (4.5247)  class_acc: 0.0469 (0.0401)  weight_decay: 0.0190 (0.0366)  time: 2.6998  data: 0.0045  max mem: 1586
Epoch: [0]  [120/176]  eta: 0:02:25  lr: 0.000055  min_lr: 0.000055  loss: 4.4725 (4.5213)  class_acc: 0.0430 (0.0403)  weight_decay: 0.0148 (0.0347)  time: 2.6537  data: 0.0040  max mem: 1586
Epoch: [0]  [130/176]  eta: 0:01:59  lr: 0.000059  min_lr: 0.000059  loss: 4.4778 (4.5181)  class_acc: 0.0391 (0.0400)  weight_decay: 0.0109 (0.0327)  time: 2.6267  data: 0.0035  max mem: 1586
Epoch: [0]  [140/176]  eta: 0:01:34  lr: 0.000064  min_lr: 0.000064  loss: 4.4738 (4.5149)  class_acc: 0.0430 (0.0403)  weight_decay: 0.0074 (0.0308)  time: 2.6489  data: 0.0043  max mem: 1586
Epoch: [0]  [150/176]  eta: 0:01:07  lr: 0.000069  min_lr: 0.000069  loss: 4.4620 (4.5107)  class_acc: 0.0430 (0.0411)  weight_decay: 0.0045 (0.0290)  time: 2.6810  data: 0.0046  max mem: 1586
Epoch: [0]  [160/176]  eta: 0:00:41  lr: 0.000073  min_lr: 0.000073  loss: 4.4669 (4.5086)  class_acc: 0.0430 (0.0411)  weight_decay: 0.0023 (0.0273)  time: 2.7158  data: 0.0046  max mem: 1586
Epoch: [0]  [170/176]  eta: 0:00:15  lr: 0.000078  min_lr: 0.000078  loss: 4.4641 (4.5054)  class_acc: 0.0391 (0.0412)  weight_decay: 0.0008 (0.0257)  time: 2.7351  data: 0.0044  max mem: 1586
Epoch: [0]  [175/176]  eta: 0:00:02  lr: 0.000080  min_lr: 0.000080  loss: 4.4575 (4.5042)  class_acc: 0.0430 (0.0412)  weight_decay: 0.0004 (0.0251)  time: 2.6084  data: 0.0042  max mem: 1586
Epoch: [0] Total time: 0:07:40 (2.6169 s / it)
Averaged stats: lr: 0.000080  min_lr: 0.000080  loss: 4.4575 (4.5042)  class_acc: 0.0430 (0.0412)  weight_decay: 0.0004 (0.0251)
Test:  [  0/176]  eta: 0:10:31  loss: 4.3976 (4.3976)  acc1: 3.5156 (3.5156)  acc5: 14.0625 (14.0625)  time: 3.5885  data: 3.3722  max mem: 1586
Test:  [ 10/176]  eta: 0:02:23  loss: 4.3977 (4.4075)  acc1: 5.0781 (5.1847)  acc5: 16.7969 (17.8267)  time: 0.8663  data: 0.3305  max mem: 1586
Test:  [ 20/176]  eta: 0:01:56  loss: 4.4134 (4.4161)  acc1: 5.0781 (4.9665)  acc5: 17.5781 (17.8571)  time: 0.6056  data: 0.0174  max mem: 1586
Test:  [ 30/176]  eta: 0:01:42  loss: 4.4134 (4.4180)  acc1: 5.0781 (4.9899)  acc5: 16.4062 (17.5277)  time: 0.6155  data: 0.0069  max mem: 1586
Test:  [ 40/176]  eta: 0:01:32  loss: 4.4363 (4.4252)  acc1: 5.0781 (4.8971)  acc5: 15.6250 (17.0922)  time: 0.6131  data: 0.0050  max mem: 1586
Test:  [ 50/176]  eta: 0:01:24  loss: 4.4523 (4.4301)  acc1: 3.9062 (4.6798)  acc5: 15.6250 (16.7356)  time: 0.6123  data: 0.0046  max mem: 1586
Test:  [ 60/176]  eta: 0:01:16  loss: 4.4576 (4.4313)  acc1: 3.9062 (4.6299)  acc5: 15.6250 (16.6560)  time: 0.6126  data: 0.0048  max mem: 1586
Test:  [ 70/176]  eta: 0:01:09  loss: 4.4299 (4.4297)  acc1: 4.2969 (4.6655)  acc5: 16.4062 (16.6978)  time: 0.6138  data: 0.0054  max mem: 1586
Test:  [ 80/176]  eta: 0:01:02  loss: 4.4337 (4.4321)  acc1: 4.6875 (4.6730)  acc5: 16.0156 (16.5750)  time: 0.6157  data: 0.0062  max mem: 1586
Test:  [ 90/176]  eta: 0:00:55  loss: 4.4364 (4.4314)  acc1: 5.0781 (4.7004)  acc5: 16.0156 (16.5822)  time: 0.6174  data: 0.0072  max mem: 1586
Test:  [100/176]  eta: 0:00:48  loss: 4.4306 (4.4326)  acc1: 4.6875 (4.6914)  acc5: 16.4062 (16.5300)  time: 0.6163  data: 0.0068  max mem: 1586
Test:  [110/176]  eta: 0:00:42  loss: 4.4297 (4.4314)  acc1: 5.0781 (4.7508)  acc5: 16.7969 (16.5857)  time: 0.6154  data: 0.0062  max mem: 1586
Test:  [120/176]  eta: 0:00:34  loss: 4.4229 (4.4320)  acc1: 4.2969 (4.6843)  acc5: 17.1875 (16.6161)  time: 0.5021  data: 0.0079  max mem: 1586
Test:  [130/176]  eta: 0:00:28  loss: 4.4229 (4.4324)  acc1: 3.5156 (4.6547)  acc5: 16.0156 (16.5792)  time: 0.4670  data: 0.0115  max mem: 1586
Test:  [140/176]  eta: 0:00:22  loss: 4.4325 (4.4336)  acc1: 4.2969 (4.6626)  acc5: 16.0156 (16.5198)  time: 0.5794  data: 0.0091  max mem: 1586
Test:  [150/176]  eta: 0:00:15  loss: 4.4377 (4.4350)  acc1: 4.2969 (4.6461)  acc5: 15.2344 (16.4244)  time: 0.6131  data: 0.0050  max mem: 1586
Test:  [160/176]  eta: 0:00:09  loss: 4.4368 (4.4349)  acc1: 4.2969 (4.6487)  acc5: 16.0156 (16.4281)  time: 0.6132  data: 0.0054  max mem: 1586
Test:  [170/176]  eta: 0:00:03  loss: 4.4408 (4.4349)  acc1: 4.6875 (4.6350)  acc5: 16.0156 (16.3537)  time: 0.6098  data: 0.0039  max mem: 1586
Test:  [175/176]  eta: 0:00:00  loss: 4.4408 (4.4349)  acc1: 4.6875 (4.6444)  acc5: 16.0156 (16.3711)  time: 0.6039  data: 0.0030  max mem: 1586
Test: Total time: 0:01:48 (0.6146 s / it)
* Acc@1 4.644 Acc@5 16.371 loss 4.435
Test:  [ 0/59]  eta: 0:01:25  loss: 3.4380 (3.4380)  acc1: 44.1406 (44.1406)  acc5: 64.4531 (64.4531)  time: 1.4433  data: 1.2487  max mem: 1586
Test:  [10/59]  eta: 0:00:31  loss: 4.2791 (4.1632)  acc1: 3.1250 (7.5284)  acc5: 16.4062 (25.0355)  time: 0.6387  data: 0.1153  max mem: 1586
Test:  [20/59]  eta: 0:00:20  loss: 4.2791 (4.2184)  acc1: 2.7344 (6.6592)  acc5: 19.5312 (24.2932)  time: 0.4926  data: 0.0018  max mem: 1586
Test:  [30/59]  eta: 0:00:16  loss: 4.1532 (4.2083)  acc1: 4.2969 (7.8755)  acc5: 25.3906 (24.2818)  time: 0.5186  data: 0.0027  max mem: 1586
Test:  [40/59]  eta: 0:00:10  loss: 4.1522 (4.1796)  acc1: 4.2969 (8.6128)  acc5: 25.3906 (26.3148)  time: 0.5396  data: 0.0033  max mem: 1586
Test:  [50/59]  eta: 0:00:04  loss: 4.1692 (4.1756)  acc1: 3.1250 (8.2797)  acc5: 23.8281 (26.2638)  time: 0.5098  data: 0.0031  max mem: 1586
Test:  [58/59]  eta: 0:00:00  loss: 4.2175 (4.1789)  acc1: 1.9531 (8.2125)  acc5: 20.3125 (26.1477)  time: 0.5343  data: 0.0036  max mem: 1586
Test: Total time: 0:00:32 (0.5494 s / it)
* Acc@1 8.212 Acc@5 26.148 loss 4.179
Epoch 0: Training Error = 100.00%, Testing Error = 100.00%

Current sparsity level: 1.0493499486937832e-07
Block 0
Layer: 0.pwconv1, Metric before mask: tensor([[0.0058, 0.0432, 0.0167,  ..., 0.0019, 0.0182, 0.0044],
        [0.0257, 0.0105, 0.0112,  ..., 0.0155, 0.0032, 0.0014],
        [0.0025, 0.0103, 0.0084,  ..., 0.0056, 0.0047, 0.0113],
        ...,
        [0.0175, 0.0082, 0.0013,  ..., 0.0130, 0.0033, 0.0339],
        [0.0081, 0.0251, 0.0332,  ..., 0.0229, 0.0445, 0.0141],
        [0.0073, 0.0017, 0.0193,  ..., 0.0084, 0.0120, 0.0193]],
       device='cuda:0')
W_mask for 0.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 96])
Weight shape for 0.pwconv1: torch.Size([384, 96])
Non-zero weights for 0.pwconv1 after pruning: 36864
Layer: 0.pwconv2, Metric before mask: tensor([[0.0203, 0.0177, 0.0195,  ..., 0.0027, 0.0038, 0.0232],
        [0.0321, 0.0155, 0.0286,  ..., 0.0038, 0.0248, 0.0017],
        [0.0019, 0.0183, 0.0156,  ..., 0.0285, 0.0128, 0.0532],
        ...,
        [0.0256, 0.0023, 0.0080,  ..., 0.0080, 0.0409, 0.0249],
        [0.0050, 0.0321, 0.0051,  ..., 0.0389, 0.0239, 0.0063],
        [0.0098, 0.0175, 0.0152,  ..., 0.0539, 0.0437, 0.0203]],
       device='cuda:0')
W_mask for 0.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([96, 384])
Weight shape for 0.pwconv2: torch.Size([96, 384])
Non-zero weights for 0.pwconv2 after pruning: 36864
Layer: 1.pwconv1, Metric before mask: tensor([[0.0105, 0.0152, 0.0003,  ..., 0.0069, 0.0074, 0.0500],
        [0.0075, 0.0426, 0.0407,  ..., 0.0017, 0.0404, 0.0186],
        [0.0227, 0.0263, 0.0116,  ..., 0.0516, 0.0058, 0.0020],
        ...,
        [0.0028, 0.0282, 0.0157,  ..., 0.0273, 0.0085, 0.0162],
        [0.0204, 0.0264, 0.0038,  ..., 0.0391, 0.0100, 0.0185],
        [0.0297, 0.0248, 0.0068,  ..., 0.0326, 0.0239, 0.0301]],
       device='cuda:0')
W_mask for 1.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 96])
Weight shape for 1.pwconv1: torch.Size([384, 96])
Non-zero weights for 1.pwconv1 after pruning: 36864
Layer: 1.pwconv2, Metric before mask: tensor([[0.0021, 0.0181, 0.0393,  ..., 0.0008, 0.0128, 0.0115],
        [0.0185, 0.0178, 0.0037,  ..., 0.0177, 0.0238, 0.0077],
        [0.0266, 0.0003, 0.0326,  ..., 0.0124, 0.0008, 0.0020],
        ...,
        [0.0024, 0.0123, 0.0084,  ..., 0.0043, 0.0065, 0.0160],
        [0.0168, 0.0062, 0.0162,  ..., 0.0373, 0.0175, 0.0224],
        [0.0292, 0.0270, 0.0137,  ..., 0.0138, 0.0126, 0.0070]],
       device='cuda:0')
W_mask for 1.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([96, 384])
Weight shape for 1.pwconv2: torch.Size([96, 384])
Non-zero weights for 1.pwconv2 after pruning: 36864
Layer: 2.pwconv1, Metric before mask: tensor([[0.0270, 0.0197, 0.0180,  ..., 0.0255, 0.0520, 0.0204],
        [0.0185, 0.0139, 0.0079,  ..., 0.0295, 0.0329, 0.0043],
        [0.0057, 0.0051, 0.0077,  ..., 0.0133, 0.0061, 0.0477],
        ...,
        [0.0279, 0.0134, 0.0054,  ..., 0.0145, 0.0349, 0.0230],
        [0.0080, 0.0088, 0.0453,  ..., 0.0002, 0.0201, 0.0021],
        [0.0051, 0.0130, 0.0043,  ..., 0.0015, 0.0091, 0.0057]],
       device='cuda:0')
W_mask for 2.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 96])
Weight shape for 2.pwconv1: torch.Size([384, 96])
Non-zero weights for 2.pwconv1 after pruning: 36864
Layer: 2.pwconv2, Metric before mask: tensor([[0.0057, 0.0199, 0.0301,  ..., 0.0174, 0.0031, 0.0556],
        [0.0197, 0.0156, 0.0440,  ..., 0.0254, 0.0187, 0.0207],
        [0.0023, 0.0105, 0.0182,  ..., 0.0224, 0.0035, 0.0074],
        ...,
        [0.0120, 0.0210, 0.0052,  ..., 0.0150, 0.0297, 0.0033],
        [0.0358, 0.0277, 0.0241,  ..., 0.0085, 0.0114, 0.0083],
        [0.0146, 0.0313, 0.0130,  ..., 0.0367, 0.0030, 0.0121]],
       device='cuda:0')
W_mask for 2.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([96, 384])
Weight shape for 2.pwconv2: torch.Size([96, 384])
Non-zero weights for 2.pwconv2 after pruning: 36864
Block 1
Layer: 0.pwconv1, Metric before mask: tensor([[0.0063, 0.0198, 0.0061,  ..., 0.0097, 0.0182, 0.0159],
        [0.0304, 0.0051, 0.0137,  ..., 0.0514, 0.0089, 0.0206],
        [0.0029, 0.0010, 0.0286,  ..., 0.0024, 0.0111, 0.0098],
        ...,
        [0.0241, 0.0297, 0.0092,  ..., 0.0076, 0.0294, 0.0128],
        [0.0107, 0.0312, 0.0240,  ..., 0.0090, 0.0025, 0.0397],
        [0.0014, 0.0136, 0.0265,  ..., 0.0249, 0.0025, 0.0134]],
       device='cuda:0')
W_mask for 0.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([768, 192])
Weight shape for 0.pwconv1: torch.Size([768, 192])
Non-zero weights for 0.pwconv1 after pruning: 147456
Layer: 0.pwconv2, Metric before mask: tensor([[0.0076, 0.0469, 0.0290,  ..., 0.0088, 0.0099, 0.0295],
        [0.0188, 0.0089, 0.0122,  ..., 0.0042, 0.0013, 0.0374],
        [0.0351, 0.0163, 0.0353,  ..., 0.0086, 0.0068, 0.0047],
        ...,
        [0.0409, 0.0181, 0.0202,  ..., 0.0136, 0.0044, 0.0022],
        [0.0206, 0.0339, 0.0094,  ..., 0.0070, 0.0043, 0.0063],
        [0.0354, 0.0223, 0.0098,  ..., 0.0307, 0.0437, 0.0302]],
       device='cuda:0')
W_mask for 0.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([192, 768])
Weight shape for 0.pwconv2: torch.Size([192, 768])
Non-zero weights for 0.pwconv2 after pruning: 147456
Layer: 1.pwconv1, Metric before mask: tensor([[0.0056, 0.0291, 0.0154,  ..., 0.0187, 0.0150, 0.0139],
        [0.0245, 0.0014, 0.0276,  ..., 0.0231, 0.0097, 0.0014],
        [0.0298, 0.0075, 0.0181,  ..., 0.0143, 0.0117, 0.0167],
        ...,
        [0.0081, 0.0124, 0.0166,  ..., 0.0542, 0.0086, 0.0165],
        [0.0192, 0.0151, 0.0130,  ..., 0.0161, 0.0182, 0.0336],
        [0.0037, 0.0109, 0.0181,  ..., 0.0338, 0.0264, 0.0079]],
       device='cuda:0')
W_mask for 1.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([768, 192])
Weight shape for 1.pwconv1: torch.Size([768, 192])
Non-zero weights for 1.pwconv1 after pruning: 147456
Layer: 1.pwconv2, Metric before mask: tensor([[0.0390, 0.0184, 0.0114,  ..., 0.0090, 0.0211, 0.0043],
        [0.0054, 0.0265, 0.0168,  ..., 0.0326, 0.0062, 0.0097],
        [0.0185, 0.0249, 0.0069,  ..., 0.0115, 0.0163, 0.0113],
        ...,
        [0.0287, 0.0056, 0.0040,  ..., 0.0160, 0.0053, 0.0043],
        [0.0261, 0.0343, 0.0154,  ..., 0.0271, 0.0120, 0.0023],
        [0.0186, 0.0073, 0.0042,  ..., 0.0269, 0.0237, 0.0402]],
       device='cuda:0')
W_mask for 1.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([192, 768])
Weight shape for 1.pwconv2: torch.Size([192, 768])
Non-zero weights for 1.pwconv2 after pruning: 147456
Layer: 2.pwconv1, Metric before mask: tensor([[1.1736e-02, 1.1819e-02, 4.4882e-02,  ..., 5.8408e-02, 8.8524e-03,
         3.1206e-03],
        [7.3376e-05, 8.2065e-03, 1.0180e-02,  ..., 1.7323e-02, 3.1056e-02,
         7.9753e-03],
        [2.5099e-02, 2.5896e-02, 1.4975e-03,  ..., 2.4244e-02, 1.4462e-02,
         1.8626e-03],
        ...,
        [4.1482e-03, 1.5497e-02, 1.7550e-02,  ..., 2.1548e-04, 7.7841e-03,
         2.1717e-02],
        [2.2423e-02, 3.9629e-02, 7.5074e-03,  ..., 2.3608e-02, 1.7062e-02,
         1.2495e-02],
        [2.6470e-02, 1.1578e-02, 2.1231e-02,  ..., 3.4606e-03, 2.4189e-02,
         3.2580e-02]], device='cuda:0')
W_mask for 2.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([768, 192])
Weight shape for 2.pwconv1: torch.Size([768, 192])
Non-zero weights for 2.pwconv1 after pruning: 147456
Layer: 2.pwconv2, Metric before mask: tensor([[0.0129, 0.0379, 0.0125,  ..., 0.0056, 0.0060, 0.0066],
        [0.0153, 0.0135, 0.0117,  ..., 0.0417, 0.0136, 0.0238],
        [0.0152, 0.0053, 0.0334,  ..., 0.0108, 0.0166, 0.0099],
        ...,
        [0.0048, 0.0070, 0.0327,  ..., 0.0320, 0.0011, 0.0322],
        [0.0136, 0.0076, 0.0055,  ..., 0.0320, 0.0007, 0.0227],
        [0.0060, 0.0321, 0.0022,  ..., 0.0342, 0.0185, 0.0161]],
       device='cuda:0')
W_mask for 2.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([192, 768])
Weight shape for 2.pwconv2: torch.Size([192, 768])
Non-zero weights for 2.pwconv2 after pruning: 147456
Block 2
Layer: 0.pwconv1, Metric before mask: tensor([[0.0419, 0.0079, 0.0363,  ..., 0.0049, 0.0177, 0.0312],
        [0.0389, 0.0269, 0.0277,  ..., 0.0021, 0.0091, 0.0249],
        [0.0440, 0.0113, 0.0199,  ..., 0.0252, 0.0149, 0.0562],
        ...,
        [0.0315, 0.0132, 0.0081,  ..., 0.0238, 0.0240, 0.0173],
        [0.0246, 0.0024, 0.0018,  ..., 0.0041, 0.0028, 0.0384],
        [0.0079, 0.0029, 0.0104,  ..., 0.0046, 0.0077, 0.0005]],
       device='cuda:0')
W_mask for 0.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 0.pwconv1: torch.Size([1536, 384])
Non-zero weights for 0.pwconv1 after pruning: 589824
Layer: 0.pwconv2, Metric before mask: tensor([[0.0150, 0.0171, 0.0083,  ..., 0.0074, 0.0081, 0.0207],
        [0.0167, 0.0242, 0.0020,  ..., 0.0123, 0.0062, 0.0037],
        [0.0072, 0.0015, 0.0209,  ..., 0.0384, 0.0175, 0.0427],
        ...,
        [0.0020, 0.0218, 0.0230,  ..., 0.0056, 0.0139, 0.0234],
        [0.0195, 0.0112, 0.0402,  ..., 0.0005, 0.0147, 0.0127],
        [0.0368, 0.0026, 0.0196,  ..., 0.0270, 0.0371, 0.0268]],
       device='cuda:0')
W_mask for 0.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 0.pwconv2: torch.Size([384, 1536])
Non-zero weights for 0.pwconv2 after pruning: 589824
Layer: 1.pwconv1, Metric before mask: tensor([[0.0029, 0.0019, 0.0238,  ..., 0.0187, 0.0383, 0.0294],
        [0.0045, 0.0333, 0.0060,  ..., 0.0148, 0.0219, 0.0011],
        [0.0010, 0.0118, 0.0051,  ..., 0.0078, 0.0095, 0.0173],
        ...,
        [0.0260, 0.0096, 0.0109,  ..., 0.0070, 0.0441, 0.0092],
        [0.0214, 0.0187, 0.0039,  ..., 0.0047, 0.0356, 0.0010],
        [0.0223, 0.0166, 0.0049,  ..., 0.0009, 0.0263, 0.0248]],
       device='cuda:0')
W_mask for 1.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 1.pwconv1: torch.Size([1536, 384])
Non-zero weights for 1.pwconv1 after pruning: 589824
Layer: 1.pwconv2, Metric before mask: tensor([[0.0023, 0.0105, 0.0016,  ..., 0.0055, 0.0025, 0.0573],
        [0.0020, 0.0085, 0.0125,  ..., 0.0027, 0.0102, 0.0019],
        [0.0215, 0.0075, 0.0315,  ..., 0.0030, 0.0108, 0.0118],
        ...,
        [0.0053, 0.0009, 0.0091,  ..., 0.0139, 0.0205, 0.0182],
        [0.0128, 0.0287, 0.0157,  ..., 0.0090, 0.0105, 0.0125],
        [0.0193, 0.0153, 0.0073,  ..., 0.0354, 0.0305, 0.0179]],
       device='cuda:0')
W_mask for 1.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 1.pwconv2: torch.Size([384, 1536])
Non-zero weights for 1.pwconv2 after pruning: 589824
Layer: 2.pwconv1, Metric before mask: tensor([[0.0011, 0.0157, 0.0188,  ..., 0.0002, 0.0279, 0.0131],
        [0.0080, 0.0100, 0.0049,  ..., 0.0109, 0.0167, 0.0268],
        [0.0244, 0.0281, 0.0005,  ..., 0.0085, 0.0064, 0.0087],
        ...,
        [0.0388, 0.0272, 0.0261,  ..., 0.0112, 0.0238, 0.0038],
        [0.0031, 0.0037, 0.0009,  ..., 0.0359, 0.0085, 0.0138],
        [0.0174, 0.0289, 0.0284,  ..., 0.0169, 0.0255, 0.0317]],
       device='cuda:0')
W_mask for 2.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 2.pwconv1: torch.Size([1536, 384])
Non-zero weights for 2.pwconv1 after pruning: 589824
Layer: 2.pwconv2, Metric before mask: tensor([[6.1812e-03, 2.0601e-02, 3.5839e-02,  ..., 9.8744e-03, 2.3991e-02,
         1.9074e-02],
        [1.5201e-02, 5.5752e-03, 4.9321e-03,  ..., 1.8269e-02, 3.1537e-02,
         3.2354e-02],
        [6.2985e-05, 1.1551e-02, 2.3323e-02,  ..., 2.0568e-02, 1.3569e-02,
         1.0273e-02],
        ...,
        [1.5253e-03, 1.0129e-02, 2.5008e-02,  ..., 7.8254e-03, 7.6681e-03,
         6.0973e-03],
        [2.1702e-02, 7.2521e-04, 4.5983e-03,  ..., 1.4075e-02, 5.9750e-03,
         2.9896e-02],
        [1.7181e-02, 2.6195e-02, 1.1873e-02,  ..., 3.0178e-02, 3.8276e-03,
         4.5618e-02]], device='cuda:0')
W_mask for 2.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 2.pwconv2: torch.Size([384, 1536])
Non-zero weights for 2.pwconv2 after pruning: 589824
Layer: 3.pwconv1, Metric before mask: tensor([[0.0281, 0.0321, 0.0005,  ..., 0.0030, 0.0106, 0.0127],
        [0.0295, 0.0042, 0.0234,  ..., 0.0142, 0.0143, 0.0103],
        [0.0076, 0.0178, 0.0030,  ..., 0.0196, 0.0136, 0.0289],
        ...,
        [0.0357, 0.0032, 0.0122,  ..., 0.0369, 0.0176, 0.0771],
        [0.0134, 0.0101, 0.0374,  ..., 0.0117, 0.0278, 0.0185],
        [0.0151, 0.0156, 0.0056,  ..., 0.0065, 0.0134, 0.0129]],
       device='cuda:0')
W_mask for 3.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 3.pwconv1: torch.Size([1536, 384])
Non-zero weights for 3.pwconv1 after pruning: 589824
Layer: 3.pwconv2, Metric before mask: tensor([[1.4512e-02, 9.9236e-03, 2.0267e-02,  ..., 9.9719e-03, 1.3854e-02,
         2.1139e-02],
        [2.7852e-02, 3.4569e-02, 2.3909e-02,  ..., 8.1069e-03, 2.8298e-02,
         1.9018e-02],
        [2.6220e-02, 1.2151e-02, 3.5438e-02,  ..., 7.6578e-03, 1.1267e-02,
         1.3785e-02],
        ...,
        [7.2588e-04, 2.1069e-02, 1.2968e-02,  ..., 1.7381e-02, 4.2766e-02,
         8.9425e-05],
        [9.1737e-03, 3.1416e-02, 4.0221e-02,  ..., 5.2762e-03, 3.0669e-02,
         8.5282e-03],
        [1.3190e-02, 1.2697e-02, 5.0152e-04,  ..., 5.0074e-02, 3.5418e-03,
         1.6407e-03]], device='cuda:0')
W_mask for 3.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 3.pwconv2: torch.Size([384, 1536])
Non-zero weights for 3.pwconv2 after pruning: 589824
Layer: 4.pwconv1, Metric before mask: tensor([[0.0303, 0.0469, 0.0135,  ..., 0.0146, 0.0060, 0.0219],
        [0.0023, 0.0172, 0.0067,  ..., 0.0187, 0.0153, 0.0136],
        [0.0396, 0.0274, 0.0090,  ..., 0.0026, 0.0165, 0.0121],
        ...,
        [0.0074, 0.0045, 0.0128,  ..., 0.0295, 0.0319, 0.0175],
        [0.0272, 0.0129, 0.0292,  ..., 0.0223, 0.0156, 0.0166],
        [0.0006, 0.0117, 0.0119,  ..., 0.0080, 0.0254, 0.0599]],
       device='cuda:0')
W_mask for 4.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 4.pwconv1: torch.Size([1536, 384])
Non-zero weights for 4.pwconv1 after pruning: 589824
Layer: 4.pwconv2, Metric before mask: tensor([[0.0060, 0.0193, 0.0076,  ..., 0.0150, 0.0204, 0.0220],
        [0.0350, 0.0307, 0.0035,  ..., 0.0354, 0.0030, 0.0205],
        [0.0380, 0.0274, 0.0084,  ..., 0.0303, 0.0158, 0.0384],
        ...,
        [0.0120, 0.0025, 0.0080,  ..., 0.0024, 0.0051, 0.0162],
        [0.0222, 0.0286, 0.0134,  ..., 0.0073, 0.0096, 0.0086],
        [0.0208, 0.0039, 0.0013,  ..., 0.0260, 0.0091, 0.0315]],
       device='cuda:0')
W_mask for 4.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 4.pwconv2: torch.Size([384, 1536])
Non-zero weights for 4.pwconv2 after pruning: 589824
Layer: 5.pwconv1, Metric before mask: tensor([[7.5709e-06, 1.2699e-02, 1.3230e-02,  ..., 5.5046e-02, 4.6312e-03,
         1.0124e-02],
        [2.5463e-02, 9.4076e-03, 2.3928e-02,  ..., 2.4465e-04, 8.7675e-03,
         3.0637e-03],
        [8.4994e-03, 8.0722e-03, 1.5217e-02,  ..., 1.6566e-02, 3.1484e-02,
         1.2969e-02],
        ...,
        [1.9605e-02, 2.3720e-02, 5.5375e-03,  ..., 1.5235e-02, 2.2551e-02,
         7.7120e-03],
        [4.0872e-02, 1.1538e-02, 3.2005e-02,  ..., 7.2640e-03, 2.3275e-02,
         6.4010e-03],
        [2.5718e-02, 3.4343e-03, 9.8432e-03,  ..., 4.9786e-05, 4.1885e-02,
         8.8986e-03]], device='cuda:0')
W_mask for 5.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 5.pwconv1: torch.Size([1536, 384])
Non-zero weights for 5.pwconv1 after pruning: 589824
Layer: 5.pwconv2, Metric before mask: tensor([[0.0331, 0.0022, 0.0160,  ..., 0.0049, 0.0064, 0.0062],
        [0.0063, 0.0106, 0.0003,  ..., 0.0173, 0.0042, 0.0007],
        [0.0010, 0.0216, 0.0208,  ..., 0.0142, 0.0047, 0.0264],
        ...,
        [0.0049, 0.0153, 0.0116,  ..., 0.0044, 0.0229, 0.0245],
        [0.0239, 0.0274, 0.0086,  ..., 0.0256, 0.0090, 0.0340],
        [0.0254, 0.0164, 0.0287,  ..., 0.0122, 0.0232, 0.0358]],
       device='cuda:0')
W_mask for 5.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 5.pwconv2: torch.Size([384, 1536])
Non-zero weights for 5.pwconv2 after pruning: 589823
Layer: 6.pwconv1, Metric before mask: tensor([[0.0253, 0.0170, 0.0006,  ..., 0.0375, 0.0141, 0.0269],
        [0.0282, 0.0121, 0.0017,  ..., 0.0352, 0.0121, 0.0287],
        [0.0025, 0.0184, 0.0057,  ..., 0.0191, 0.0028, 0.0136],
        ...,
        [0.0247, 0.0058, 0.0070,  ..., 0.0221, 0.0045, 0.0355],
        [0.0323, 0.0397, 0.0214,  ..., 0.0197, 0.0327, 0.0127],
        [0.0232, 0.0116, 0.0054,  ..., 0.0256, 0.0032, 0.0353]],
       device='cuda:0')
W_mask for 6.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 6.pwconv1: torch.Size([1536, 384])
Non-zero weights for 6.pwconv1 after pruning: 589823
Layer: 6.pwconv2, Metric before mask: tensor([[0.0103, 0.0169, 0.0143,  ..., 0.0046, 0.0294, 0.0070],
        [0.0068, 0.0158, 0.0426,  ..., 0.0258, 0.0208, 0.0204],
        [0.0374, 0.0194, 0.0190,  ..., 0.0175, 0.0145, 0.0345],
        ...,
        [0.0177, 0.0150, 0.0010,  ..., 0.0020, 0.0005, 0.0029],
        [0.0321, 0.0152, 0.0139,  ..., 0.0160, 0.0479, 0.0164],
        [0.0146, 0.0170, 0.0288,  ..., 0.0136, 0.0413, 0.0102]],
       device='cuda:0')
W_mask for 6.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 6.pwconv2: torch.Size([384, 1536])
Non-zero weights for 6.pwconv2 after pruning: 589824
Layer: 7.pwconv1, Metric before mask: tensor([[0.0259, 0.0209, 0.0496,  ..., 0.0041, 0.0077, 0.0296],
        [0.0181, 0.0012, 0.0131,  ..., 0.0033, 0.0256, 0.0140],
        [0.0101, 0.0310, 0.0110,  ..., 0.0290, 0.0083, 0.0041],
        ...,
        [0.0135, 0.0047, 0.0403,  ..., 0.0070, 0.0054, 0.0355],
        [0.0021, 0.0186, 0.0110,  ..., 0.0065, 0.0114, 0.0021],
        [0.0289, 0.0038, 0.0201,  ..., 0.0177, 0.0061, 0.0325]],
       device='cuda:0')
W_mask for 7.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 7.pwconv1: torch.Size([1536, 384])
Non-zero weights for 7.pwconv1 after pruning: 589824
Layer: 7.pwconv2, Metric before mask: tensor([[0.0023, 0.0187, 0.0052,  ..., 0.0078, 0.0053, 0.0103],
        [0.0060, 0.0058, 0.0028,  ..., 0.0152, 0.0395, 0.0302],
        [0.0155, 0.0229, 0.0211,  ..., 0.0451, 0.0248, 0.0146],
        ...,
        [0.0220, 0.0134, 0.0021,  ..., 0.0050, 0.0031, 0.0345],
        [0.0201, 0.0029, 0.0039,  ..., 0.0184, 0.0052, 0.0149],
        [0.0068, 0.0140, 0.0028,  ..., 0.0283, 0.0129, 0.0001]],
       device='cuda:0')
W_mask for 7.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 7.pwconv2: torch.Size([384, 1536])
Non-zero weights for 7.pwconv2 after pruning: 589824
Layer: 8.pwconv1, Metric before mask: tensor([[1.8415e-02, 2.4682e-02, 1.7911e-02,  ..., 3.1004e-02, 4.9373e-02,
         7.2505e-03],
        [1.8139e-02, 5.2965e-03, 3.6897e-02,  ..., 1.6119e-02, 4.4596e-02,
         1.2792e-02],
        [4.7104e-03, 1.4413e-02, 7.7211e-03,  ..., 1.3471e-02, 2.6386e-02,
         1.3218e-02],
        ...,
        [5.4581e-04, 8.1132e-05, 8.5992e-03,  ..., 1.4218e-02, 4.6598e-02,
         6.2648e-03],
        [1.9354e-03, 1.9592e-02, 2.1423e-03,  ..., 2.5618e-02, 1.1500e-02,
         2.1728e-02],
        [1.2852e-02, 2.8189e-02, 1.7617e-02,  ..., 4.4904e-02, 1.6844e-02,
         4.2827e-03]], device='cuda:0')
W_mask for 8.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([1536, 384])
Weight shape for 8.pwconv1: torch.Size([1536, 384])
Non-zero weights for 8.pwconv1 after pruning: 589824
Layer: 8.pwconv2, Metric before mask: tensor([[0.0265, 0.0199, 0.0030,  ..., 0.0126, 0.0156, 0.0125],
        [0.0021, 0.0103, 0.0024,  ..., 0.0202, 0.0191, 0.0085],
        [0.0348, 0.0160, 0.0184,  ..., 0.0236, 0.0235, 0.0143],
        ...,
        [0.0009, 0.0191, 0.0221,  ..., 0.0402, 0.0243, 0.0061],
        [0.0261, 0.0319, 0.0258,  ..., 0.0233, 0.0203, 0.0054],
        [0.0460, 0.0220, 0.0077,  ..., 0.0042, 0.0031, 0.0242]],
       device='cuda:0')
W_mask for 8.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([384, 1536])
Weight shape for 8.pwconv2: torch.Size([384, 1536])
Non-zero weights for 8.pwconv2 after pruning: 589824
Block 3
Layer: 0.pwconv1, Metric before mask: tensor([[0.0059, 0.0013, 0.0234,  ..., 0.0044, 0.0096, 0.0218],
        [0.0083, 0.0074, 0.0010,  ..., 0.0229, 0.0045, 0.0228],
        [0.0100, 0.0266, 0.0084,  ..., 0.0206, 0.0240, 0.0169],
        ...,
        [0.0090, 0.0084, 0.0223,  ..., 0.0235, 0.0011, 0.0347],
        [0.0082, 0.0502, 0.0104,  ..., 0.0115, 0.0342, 0.0105],
        [0.0064, 0.0266, 0.0035,  ..., 0.0014, 0.0037, 0.0234]],
       device='cuda:0')
W_mask for 0.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([3072, 768])
Weight shape for 0.pwconv1: torch.Size([3072, 768])
Non-zero weights for 0.pwconv1 after pruning: 2359296
Layer: 0.pwconv2, Metric before mask: tensor([[0.0216, 0.0102, 0.0128,  ..., 0.0183, 0.0222, 0.0381],
        [0.0080, 0.0314, 0.0113,  ..., 0.0064, 0.0109, 0.0329],
        [0.0314, 0.0204, 0.0277,  ..., 0.0209, 0.0075, 0.0267],
        ...,
        [0.0011, 0.0036, 0.0323,  ..., 0.0270, 0.0267, 0.0171],
        [0.0109, 0.0180, 0.0241,  ..., 0.0187, 0.0083, 0.0068],
        [0.0094, 0.0289, 0.0069,  ..., 0.0096, 0.0322, 0.0067]],
       device='cuda:0')
W_mask for 0.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([768, 3072])
Weight shape for 0.pwconv2: torch.Size([768, 3072])
Non-zero weights for 0.pwconv2 after pruning: 2359296
Layer: 1.pwconv1, Metric before mask: tensor([[0.0008, 0.0246, 0.0087,  ..., 0.0038, 0.0015, 0.0129],
        [0.0246, 0.0085, 0.0062,  ..., 0.0165, 0.0146, 0.0089],
        [0.0225, 0.0022, 0.0312,  ..., 0.0092, 0.0056, 0.0311],
        ...,
        [0.0311, 0.0337, 0.0091,  ..., 0.0161, 0.0026, 0.0183],
        [0.0197, 0.0226, 0.0009,  ..., 0.0042, 0.0144, 0.0100],
        [0.0048, 0.0032, 0.0347,  ..., 0.0199, 0.0121, 0.0180]],
       device='cuda:0')
W_mask for 1.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([3072, 768])
Weight shape for 1.pwconv1: torch.Size([3072, 768])
Non-zero weights for 1.pwconv1 after pruning: 2359296
Layer: 1.pwconv2, Metric before mask: tensor([[0.0084, 0.0031, 0.0273,  ..., 0.0137, 0.0148, 0.0366],
        [0.0525, 0.0115, 0.0490,  ..., 0.0056, 0.0150, 0.0220],
        [0.0126, 0.0052, 0.0122,  ..., 0.0347, 0.0246, 0.0308],
        ...,
        [0.0437, 0.0110, 0.0225,  ..., 0.0020, 0.0030, 0.0114],
        [0.0145, 0.0098, 0.0177,  ..., 0.0294, 0.0236, 0.0069],
        [0.0021, 0.0030, 0.0296,  ..., 0.0113, 0.0301, 0.0003]],
       device='cuda:0')
W_mask for 1.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([768, 3072])
Weight shape for 1.pwconv2: torch.Size([768, 3072])
Non-zero weights for 1.pwconv2 after pruning: 2359296
Layer: 2.pwconv1, Metric before mask: tensor([[0.0226, 0.0055, 0.0056,  ..., 0.0088, 0.0189, 0.0224],
        [0.0287, 0.0366, 0.0170,  ..., 0.0288, 0.0248, 0.0038],
        [0.0186, 0.0154, 0.0012,  ..., 0.0258, 0.0185, 0.0073],
        ...,
        [0.0288, 0.0395, 0.0020,  ..., 0.0245, 0.0024, 0.0286],
        [0.0100, 0.0032, 0.0301,  ..., 0.0207, 0.0073, 0.0273],
        [0.0104, 0.0524, 0.0182,  ..., 0.0105, 0.0361, 0.0194]],
       device='cuda:0')
W_mask for 2.pwconv1: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([3072, 768])
Weight shape for 2.pwconv1: torch.Size([3072, 768])
Non-zero weights for 2.pwconv1 after pruning: 2359295
Layer: 2.pwconv2, Metric before mask: tensor([[0.0181, 0.0180, 0.0248,  ..., 0.0214, 0.0144, 0.0129],
        [0.0066, 0.0077, 0.0036,  ..., 0.0230, 0.0164, 0.0209],
        [0.0206, 0.0093, 0.0035,  ..., 0.0047, 0.0408, 0.0099],
        ...,
        [0.0127, 0.0277, 0.0336,  ..., 0.0049, 0.0160, 0.0151],
        [0.0285, 0.0213, 0.0012,  ..., 0.0410, 0.0279, 0.0322],
        [0.0230, 0.0013, 0.0362,  ..., 0.0324, 0.0317, 0.0103]],
       device='cuda:0')
W_mask for 2.pwconv2: tensor([[False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        ...,
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False],
        [False, False, False,  ..., False, False, False]], device='cuda:0'), Shape: torch.Size([768, 3072])
Weight shape for 2.pwconv2: torch.Size([768, 3072])
Non-zero weights for 2.pwconv2 after pruning: 2359296
Actual sparsity after pruning: 1.0493499486937832e-07
Epoch: [0]  [  0/176]  eta: 0:15:41  lr: 0.000000  min_lr: 0.000000  loss: 4.4624 (4.4624)  class_acc: 0.0469 (0.0469)  weight_decay: 0.0500 (0.0500)  time: 5.3514  data: 3.4981  max mem: 1586
Epoch: [0]  [ 10/176]  eta: 0:07:19  lr: 0.000005  min_lr: 0.000005  loss: 4.4500 (4.4411)  class_acc: 0.0469 (0.0483)  weight_decay: 0.0499 (0.0499)  time: 2.6455  data: 0.3205  max mem: 1586
Epoch: [0]  [ 20/176]  eta: 0:06:29  lr: 0.000009  min_lr: 0.000009  loss: 4.4284 (4.4311)  class_acc: 0.0469 (0.0493)  weight_decay: 0.0495 (0.0495)  time: 2.3562  data: 0.0019  max mem: 1586
Epoch: [0]  [ 30/176]  eta: 0:06:02  lr: 0.000014  min_lr: 0.000014  loss: 4.4196 (4.4286)  class_acc: 0.0430 (0.0493)  weight_decay: 0.0482 (0.0488)  time: 2.3953  data: 0.0021  max mem: 1586
Traceback (most recent call last):
  File "/media/shahanahmed/b8c6fb5d-b937-4730-bb0f-ac0eba675d7e/Wanda_pruning_for_image_classification/main.py", line 531, in <module>
    main(args)
  File "/media/shahanahmed/b8c6fb5d-b937-4730-bb0f-ac0eba675d7e/Wanda_pruning_for_image_classification/main.py", line 524, in main
    train_with_pruning(model,dataset_train, dataset_val,device,args)
  File "/media/shahanahmed/b8c6fb5d-b937-4730-bb0f-ac0eba675d7e/Wanda_pruning_for_image_classification/main.py", line 354, in train_with_pruning
    train_stats = train_one_epoch(
  File "/media/shahanahmed/b8c6fb5d-b937-4730-bb0f-ac0eba675d7e/Wanda_pruning_for_image_classification/engine.py", line 106, in train_one_epoch
    torch.cuda.synchronize()
  File "/home/shahanahmed/.local/lib/python3.10/site-packages/torch/cuda/__init__.py", line 892, in synchronize
    return torch._C._cuda_synchronize()
KeyboardInterrupt
Traceback (most recent call last):
  File "/media/shahanahmed/b8c6fb5d-b937-4730-bb0f-ac0eba675d7e/Wanda_pruning_for_image_classification/main.py", line 531, in <module>
    main(args)
  File "/media/shahanahmed/b8c6fb5d-b937-4730-bb0f-ac0eba675d7e/Wanda_pruning_for_image_classification/main.py", line 524, in main
    train_with_pruning(model,dataset_train, dataset_val,device,args)
  File "/media/shahanahmed/b8c6fb5d-b937-4730-bb0f-ac0eba675d7e/Wanda_pruning_for_image_classification/main.py", line 354, in train_with_pruning
    train_stats = train_one_epoch(
  File "/media/shahanahmed/b8c6fb5d-b937-4730-bb0f-ac0eba675d7e/Wanda_pruning_for_image_classification/engine.py", line 106, in train_one_epoch
    torch.cuda.synchronize()
  File "/home/shahanahmed/.local/lib/python3.10/site-packages/torch/cuda/__init__.py", line 892, in synchronize
    return torch._C._cuda_synchronize()
KeyboardInterrupt
